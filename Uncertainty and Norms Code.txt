#########################################################################################################################################################################################
# This code is designed to produce all of the elements of the paper "Uncertainty, volatility and the persistence norms of financial time series"					#
# Prior to running the code please make sure that you have the listed packages installed and available to your R installation. Also prepare the working directory.			#
#																							#
# If you make use of the code then please do not forget to cite the paper to which this code relates											#
#																							#
# Suggested citation: Rudkin, S., Qiu, W., and Dlotko, P. (2023) "Uncertainty, volatility and the persistence norms of financial time series", Expert Systems with Applications, 119894	#		
#########################################################################################################################################################################################

### Packages

library(TDA)
library(readstata13)
library(dplyr)
library(ggplot2)
library(lubridate)
library(lmtest)
library(sandwich)
library(car)

maxdimension<-1
maxscale<-200

#########################################################################################################################################################################################################################
# In order to use this code you will need a file with the stock index returns from Yahoo Finance and a single csv containing the uncertainty indexes prepared according to the file "Uncertainty Data Preparation.txt"	#
#																											#
# Please replace the file names with those that you have created. Likewise set the working directory accordingly													#
#########################################################################################################################################################################################################################

setwd("D://uncertainty/")

### Read in uncertainty

dtu<-read.table("uncertainty1221.csv",sep=",",header=TRUE)

### Correct format of date variable name

names(dtu)<-c("dt",names(dtu)[2:19])

### Read in stock data

dt2<-read.dta13("cloud4.dta")

### Create a variable ymo of the form 199912 to identify each month

dtu$ymo<-paste0(substr(dtu$dt,7,10),substr(dtu$dt,4,5))
dt2$ymo<-as.numeric(as.character(paste0(substr(dt2$dt,1,4),substr(dt2$dt,6,7))))

dt2t<-as.data.frame(table(dt2$ymo)) ### Table of months
names(dt2t)<-c("ymo","freq")
dt2t$ymo<-as.numeric(as.character(dt2t$ymo))
x401<-nrow(dt2t) ### Identifies number of months in the sample

dcolc<-matrix(0,nrow=x401,ncol=17) ### Collection matrix for 1 month
dcold<-matrix(0,nrow=x401,ncol=17) ### Collection matrix for 3 months
dcole<-matrix(0,nrow=x401,ncol=17) ### Collection matrix for 6 months
dcolf<-matrix(0,nrow=x401,ncol=17) ### Collection matrix for 12 months

#################################################################################################################
# This next block of code is a loop which will compute the persistence norms for the relevant number of months	#
# Please note that this loop does take time to execute and will depend on the speed of your computer            #
# Time may be saved by not running all four cloud lengths in the same loop                                      #
#################################################################################################################

for(i in 13:x401){
   x001<-i-3
   x002<-i-6
   x003<-i-12
   tempc<-subset(dt2,dt2$ymo==dt2t$ymo[i]) ### Makes 1 month subset
   tempd<-subset(dt2,dt2$ymo<=dt2t$ymo[i])
   tempd<-subset(tempd,tempd$ymo>dt2t$ymo[x001]) ### Makes 3 month measure
   tempe<-subset(dt2,dt2$ymo<=dt2t$ymo[i])
   tempe<-subset(tempe,tempe$ymo>dt2t$ymo[x002]) ### Makes 6 month measure
   tempf<-subset(dt2,dt2$ymo<=dt2t$ymo[i])
   tempf<-subset(tempf,tempf$ymo>dt2t$ymo[x003]) ### Makes 12 month measure
   x005<-i
   x<-tempc[,2:5] ### returns data is in columns 2 3 4 and 5
   Diag <- ripsDiag(X=x, maxdimension, maxscale, library="GUDHI", printProgress=FALSE)
   dt1<-as.data.frame(print(Diag[["diagram"]]) )
   dt1<-dt1[2:nrow(dt1),]
   if(nrow(dt1)>1){names(dt1)<-c("dim","b","d") ### Only runs this loop if at least one feature is identified
   dt1$pers<-dt1$d-dt1$b ### pers is the time between birth and death of the feature
   dt1$pers2<-dt1$pers^2 ### square for L2 norm
   dt1<-dt1[!is.na(dt1["pers"]),]
   dt1a<-subset(dt1,dt1$dim==0) ### Identifies the dimension 0 features
   dt1a<-dt1a[-1] ### Drop first line because the first feature is always infinitely lived (up to the maximum scale specified at the start of the code
   dt1b<-subset(dt1,dt1$dim==1) ### Identifies the dimension 1 features
   dcolc[x005,3]<-dt2t$ymo[i]
   dcolc[x005,4]<-sum(dt1a$pers) ### Total L1 norm for dimension 0
   dcolc[x005,5]<-sqrt(sum(dt1a$pers2)) ### Total L2 norm for dimension 0
   dcolc[x005,6]<-ifelse(nrow(dt1b)==0,0,sum(dt1b$pers)) ### L1 norm for dimension 1
   dcolc[x005,7]<-ifelse(nrow(dt1b)==0,0,sqrt(sum(dt1b$pers2))) ### L2 norm for dimension 1
   dcolc[x005,8]<-sd(x[,1]) ### Standard deviations for each of the four series
   dcolc[x005,9]<-sd(x[,2])
   dcolc[x005,10]<-sd(x[,3])
   dcolc[x005,11]<-sd(x[,4])
   dcolc[x005,12]<-cor(x[,1],x[,2]) ### Pairwise correlations for each possible pairing
   dcolc[x005,13]<-cor(x[,1],x[,3])
   dcolc[x005,14]<-cor(x[,1],x[,4])
   dcolc[x005,15]<-cor(x[,2],x[,3])
   dcolc[x005,16]<-cor(x[,2],x[,4])
   dcolc[x005,17]<-cor(x[,3],x[,4])
   dcolc[x005,1]<-mean(dcolc[x005,8:11]) # Average sd
   dcolc[x005,2]<-mean(dcolc[x005,12:17]) # Average cor
   }
   x<-tempd[,2:5]
   Diag <- ripsDiag(X=x, maxdimension, maxscale, library="GUDHI", printProgress=FALSE)
   dt1<-as.data.frame(print(Diag[["diagram"]]) )
   dt1<-dt1[2:nrow(dt1),]
   if(nrow(dt1)>1){names(dt1)<-c("dim","b","d")
   dt1$pers<-dt1$d-dt1$b
   dt1$pers2<-dt1$pers^2
   dt1<-dt1[!is.na(dt1["pers"]),]
   dt1a<-subset(dt1,dt1$dim==0)
   dt1a<-dt1a[-1]
   dt1b<-subset(dt1,dt1$dim==1)
   dcold[x005,3]<-dt2t$ymo[i]
   dcold[x005,4]<-sum(dt1a$pers)
   dcold[x005,5]<-sqrt(sum(dt1a$pers2))
   dcold[x005,6]<-ifelse(nrow(dt1b)==0,0,sum(dt1b$pers))
   dcold[x005,7]<-ifelse(nrow(dt1b)==0,0,sqrt(sum(dt1b$pers2)))
   dcold[x005,8]<-sd(x[,1])
   dcold[x005,9]<-sd(x[,2])
   dcold[x005,10]<-sd(x[,3])
   dcold[x005,11]<-sd(x[,4])
   dcold[x005,12]<-cor(x[,1],x[,2])
   dcold[x005,13]<-cor(x[,1],x[,3])
   dcold[x005,14]<-cor(x[,1],x[,4])
   dcold[x005,15]<-cor(x[,2],x[,3])
   dcold[x005,16]<-cor(x[,2],x[,4])
   dcold[x005,17]<-cor(x[,3],x[,4])
   dcold[x005,1]<-mean(dcold[x005,8:11]) # Average sd
   dcold[x005,2]<-mean(dcold[x005,12:17]) # Average cor
   }
   x<-tempe[,2:5]
   Diag <- ripsDiag(X=x, maxdimension, maxscale, library="GUDHI", printProgress=FALSE)
   dt1<-as.data.frame(print(Diag[["diagram"]]) )
   dt1<-dt1[2:nrow(dt1),]
   if(nrow(dt1)>1){names(dt1)<-c("dim","b","d")
   dt1$pers<-dt1$d-dt1$b
   dt1$pers2<-dt1$pers^2
   dt1<-dt1[!is.na(dt1["pers"]),]
   dt1a<-subset(dt1,dt1$dim==0)
   dt1a<-dt1a[-1]
   dt1b<-subset(dt1,dt1$dim==1)
   dcole[x005,3]<-dt2t$ymo[i]
   dcole[x005,4]<-sum(dt1a$pers)
   dcole[x005,5]<-sqrt(sum(dt1a$pers2))
   dcole[x005,6]<-ifelse(nrow(dt1b)==0,0,sum(dt1b$pers))
   dcole[x005,7]<-ifelse(nrow(dt1b)==0,0,sqrt(sum(dt1b$pers2)))
   dcole[x005,8]<-sd(x[,1])
   dcole[x005,9]<-sd(x[,2])
   dcole[x005,10]<-sd(x[,3])
   dcole[x005,11]<-sd(x[,4])
   dcole[x005,12]<-cor(x[,1],x[,2])
   dcole[x005,13]<-cor(x[,1],x[,3])
   dcole[x005,14]<-cor(x[,1],x[,4])
   dcole[x005,15]<-cor(x[,2],x[,3])
   dcole[x005,16]<-cor(x[,2],x[,4])
   dcole[x005,17]<-cor(x[,3],x[,4])
   dcole[x005,1]<-mean(dcole[x005,8:11]) # Average sd
   dcole[x005,2]<-mean(dcole[x005,12:17]) # Average cor
   }
   x<-tempf[,2:5]
   Diag <- ripsDiag(X=x, maxdimension, maxscale, library="GUDHI", printProgress=FALSE)
   dt1<-as.data.frame(print(Diag[["diagram"]]) )
   dt1<-dt1[2:nrow(dt1),]
   if(nrow(dt1)>1){names(dt1)<-c("dim","b","d")
   dt1$pers<-dt1$d-dt1$b
   dt1$pers2<-dt1$pers^2
   dt1<-dt1[!is.na(dt1["pers"]),]
   dt1a<-subset(dt1,dt1$dim==0)
   dt1a<-dt1a[-1]
   dt1b<-subset(dt1,dt1$dim==1)
   dcolf[x005,3]<-dt2t$ymo[i]
   dcolf[x005,4]<-sum(dt1a$pers)
   dcolf[x005,5]<-sqrt(sum(dt1a$pers2))
   dcolf[x005,6]<-ifelse(nrow(dt1b)==0,0,sum(dt1b$pers))
   dcolf[x005,7]<-ifelse(nrow(dt1b)==0,0,sqrt(sum(dt1b$pers2)))
   dcolf[x005,8]<-sd(x[,1])
   dcolf[x005,9]<-sd(x[,2])
   dcolf[x005,10]<-sd(x[,3])
   dcolf[x005,11]<-sd(x[,4])
   dcolf[x005,12]<-cor(x[,1],x[,2])
   dcolf[x005,13]<-cor(x[,1],x[,3])
   dcolf[x005,14]<-cor(x[,1],x[,4])
   dcolf[x005,15]<-cor(x[,2],x[,3])
   dcolf[x005,16]<-cor(x[,2],x[,4])
   dcolf[x005,17]<-cor(x[,3],x[,4])
   dcolf[x005,1]<-mean(dcolf[x005,8:11]) # Average sd
   dcolf[x005,2]<-mean(dcolf[x005,12:17]) # Average cor
 }
}

### Convert collected data to data frame 

dcolc<-as.data.frame(dcolc) 
dcold<-as.data.frame(dcold)
dcole<-as.data.frame(dcole)
dcolf<-as.data.frame(dcolf)

### Add names to dcol  dataframes ###

names(dcolc)<-c("msdc","mcorc","ymo","l01c2","l02c2","l11c2","l12c2","sd1c2","sd2c2","sd3c2","sd4c2","cor11c","cor12c","cor13c","cor23c","cor24c","cor34c")
names(dcold)<-c("msdd","mcord","ymo","l01d2","l02d2","l11d2","l12d2","sd1d2","sd2d2","sd3d2","sd4d2","cor11d","cor12d","cor13d","cor23d","cor24d","cor34d")
names(dcole)<-c("msde","mcore","ymo","l01e2","l02e2","l11e2","l12e2","sd1e2","sd2e2","sd3e2","sd4e2","cor11e","cor12e","cor13e","cor23e","cor24e","cor34e")
names(dcolf)<-c("msdf","mcorf","ymo","l01f2","l02f2","l11f2","l12f2","sd1f2","sd2f2","sd3f2","sd4f2","cor11f","cor12f","cor13f","cor23f","cor24f","cor34f")

### Formatting of date. All set to 28th as this is the last number in every month

dcolc$dt<-as.Date(paste0("28-",substr(dcolc$ymo,5,6),"-",substr(dcolc$ymo,1,4)),format="%d-%m-%Y")
dcold$dt<-as.Date(paste0("28-",substr(dcold$ymo,5,6),"-",substr(dcold$ymo,1,4)),format="%d-%m-%Y")
dcole$dt<-as.Date(paste0("28-",substr(dcole$ymo,5,6),"-",substr(dcole$ymo,1,4)),format="%d-%m-%Y")
dcolf$dt<-as.Date(paste0("28-",substr(dcolf$ymo,5,6),"-",substr(dcolf$ymo,1,4)),format="%d-%m-%Y")

### Remove any redundant lines from the dataframes

dcolca<-subset(dcolc,dcolc$sd1c2!=0)
dcolda<-subset(dcold,dcold$sd1d2!=0)
dcolea<-subset(dcole,dcole$sd1e2!=0)
dcolfa<-subset(dcolf,dcolf$sd1f2!=0)

### Merge with uncertainty data

dtuca<-merge(dtu,dcolca,by="ymo")
dtuda<-merge(dtu,dcolda,by="ymo")
dtuea<-merge(dtu,dcolea,by="ymo")
dtufa<-merge(dtu,dcolfa,by="ymo")

######################

save.dta13(dtuca,"dtuca2005222.dta")
save.dta13(dtuda,"dtuda2005222.dta")
save.dta13(dtuea,"dtuea2005222.dta")
save.dta13(dtufa,"dtufa2005222.dta")


##################################
# Summary Statistics for Table 1 #
##################################

# Two user defined functions are provided here.

sstatsmat<-function(characteristics,decp){
 if(missing(decp)) decp <- 2
 a001<-ncol(characteristics)
 sstats<-matrix(0,nrow=a001,ncol=5)
 for(i in 1:a001){
  j<-i
  sstats[i,1]<-names(characteristics)[j]
  sstats[i,2]<-round(mean(characteristics[,j]),decp)
  sstats[i,3]<-round(sd(characteristics[,j]),decp)
  sstats[i,4]<-round(min(characteristics[,j]),decp)
  sstats[i,5]<-round(max(characteristics[,j]),decp)
 }
 return(sstats)
}

sstatsmatdet<-function(characteristics,decp){
 if(missing(decp)) decp <- 2
 a001<-ncol(characteristics)
 sstats<-matrix(0,nrow=a001,ncol=8)
 for(i in 1:a001){
  j<-i
  sstats[i,1]<-names(characteristics)[j]
  sstats[i,2]<-round(mean(characteristics[,j]),decp)
  sstats[i,3]<-round(sd(characteristics[,j]),decp)
  sstats[i,4]<-round(min(characteristics[,j]),decp)
  sstats[i,5]<-round(quantile(characteristics[,j],0.25),decp)
  sstats[i,6]<-round(quantile(characteristics[,j],0.50),decp)
  sstats[i,7]<-round(quantile(characteristics[,j],0.75),decp)
  sstats[i,8]<-round(max(characteristics[,j]),decp)
 }
 return(sstats)
}

dfc<-as.data.frame(cbind.data.frame(dtuca$l11c2,dtuca$l12c2,dtuca$msdc,dtuca$finunc1,dtuca$macunc1))
dfd<-as.data.frame(cbind.data.frame(dtuda$l11d2,dtuda$l12d2,dtuda$msdd,dtuda$finunc1,dtuda$macunc1))
dfe<-as.data.frame(cbind.data.frame(dtuea$l11e2,dtuea$l12e2,dtuea$msde,dtuea$finunc1,dtuea$macunc1))
dff<-as.data.frame(cbind.data.frame(dtufa$l11f2,dtufa$l12f2,dtufa$msdf,dtufa$finunc1,dtufa$macunc1))

s001<-sstatsmat(dfc,3)
s002<-sstatsmat(dfd,3)
s003<-sstatsmat(dfe,3)
s004<-sstatsmat(dff,3)
s101<-sstatsmatdet(dfc,3)
s102<-sstatsmatdet(dfd,3)
s103<-sstatsmatdet(dfe,3)
s104<-sstatsmatdet(dff,3)

latout(s001,"sstatsc.txt")
latout(s002,"sstatsd.txt")
latout(s003,"sstatse.txt")
latout(s004,"sstatsf.txt")
latout(s101,"sstatsc1.txt")
latout(s102,"sstatsd1.txt")
latout(s103,"sstatse1.txt")
latout(s104,"sstatsf1.txt")

sstatsa<-rbind(s001[1:3,],s002[1:3,],s003[1:3,],s004)
sstatsb<-rbind(s101[1:3,],s102[1:3,],s103[1:3,],s104)

latout(sstatsa,"sstatsbasic.txt")
latout(sstatsb,"Table1.txt") 


#######################################################
# Next stage is correlations between measures that appear in Appendix B #
#######################################################

### First make temporary dataframes combining the same variable from four cloud lengths:

dt5a<-as.data.frame(cbind.data.frame(dtuca$msdc,dtuda$msdd,dtuea$msde,dtufa$msdf))
dt5b<-as.data.frame(cbind.data.frame(dtuca$l11c2,dtuda$l11d2,dtuea$l11e2,dtufa$l11f2))
dt5c<-as.data.frame(cbind.data.frame(dtuca$l12c2,dtuda$l12d2,dtuea$l12e2,dtufa$l12f2))

### Now produce 3 4x4 pairwise correlation matrices

cormatf<-matrix(1,nrow=4,ncol=4) ### Temporary 4x4 matrix to store correlations

for(i in 1:4){
 for(j in 1:4){
   x001<-cor(dt5a[,i],dt5a[,j]) ### Pearson correlation for below the diagonal
   x002<-cor(dt5a[,i],dt5a[,j],method="spearman") ### Spearman rank for above the diagonal
   cormatf[i,j]<-ifelse(i>=j,x001,x002) ### Determines which number to put into the matrix
 }
}

for(i in 1:4){
 for(j in 1:4){
  cormatf[i,j]<-round(cormatf[i,j],3) ### Rounds to 3 decimal places
 }
}
 
cormat5a<-cormatf ### Store readfy for combining later

cormatf<-matrix(1,nrow=4,ncol=4)

for(i in 1:4){
 for(j in 1:4){
   x001<-cor(dt5b[,i],dt5b[,j])
   x002<-cor(dt5b[,i],dt5b[,j],method="spearman")
   cormatf[i,j]<-ifelse(i>=j,x001,x002)
 }
}

for(i in 1:4){
 for(j in 1:4){
  cormatf[i,j]<-round(cormatf[i,j],3)
 }
}

cormat5b<-cormatf

cormatf<-matrix(1,nrow=4,ncol=4)

for(i in 1:4){
 for(j in 1:4){
   x001<-cor(dt5c[,i],dt5c[,j])
   x002<-cor(dt5c[,i],dt5c[,j],method="spearman")
   cormatf[i,j]<-ifelse(i>=j,x001,x002)
 }
}

for(i in 1:4){
 for(j in 1:4){
  cormatf[i,j]<-round(cormatf[i,j],3)
 }
}

cormat5c<-cormatf

cormat5d<-cbind(cormat5a,cormat5b,cormat5c) ### Place three matrices next to each other

write.table(cormat5d,"TableA2.csv",sep=",",row.names=FALSE) ### Output file into working directory for formatting

#######################################################
# cormat5d may be outputted as Table A2 of the supplementary material #
#									#
# Next we produce the correlation table, Table 1 of the main paper	#
#######################################################

### We combine the 6 variables for which the correlation will be constructed into a dataframe

dtuca3<-as.data.frame(cbind.data.frame(dtuca$finunc1,dtuca$macunc1,dtuca$reaunc1,dtuca$msdc,dtuca$l11c2,dtuca$l12c2)) 

cormatf<-matrix(1,nrow=6,ncol=6)

for(i in 1:6){
 for(j in 1:6){
   x001<-cor(dtuca3[,i],dtuca3[,j]) ### Pearson correlation
   x002<-cor(dtuca3[,i],dtuca3[,j],method="spearman") ### Spearman rank correlation
   cormatf[i,j]<-ifelse(i>=j,x001,x002) ### Determines which element goes into the matrix.
 }
}

### This loop then rounds everything to 3 decimal places

for(i in 1:6){
 for(j in 1:6){
  cormatf[i,j]<-round(cormatf[i,j],3)
 }
}

cormatfc<-cormatf ### Store correlation matrix for later

dtuda3<-as.data.frame(cbind.data.frame(dtuda$finunc1,dtuda$macunc1,dtuda$reaunc1,dtuda$msdd,dtuda$l11d2,dtuda$l12d2))

cormatf<-matrix(1,nrow=6,ncol=6)

for(i in 1:6){
 for(j in 1:6){
   x001<-cor(dtuda3[,i],dtuda3[,j])
   x002<-cor(dtuda3[,i],dtuda3[,j],method="spearman")
   cormatf[i,j]<-ifelse(i>=j,x001,x002)
 }
}

for(i in 1:6){
 for(j in 1:6){
  cormatf[i,j]<-round(cormatf[i,j],3)
 }
}

cormatfd<-cormatf

dtuea3<-as.data.frame(cbind.data.frame(dtuea$finunc1,dtuea$macunc1,dtuea$reaunc1,dtuea$msde,dtuea$l11e2,dtuea$l12e2))

cormatf<-matrix(1,nrow=6,ncol=6)

for(i in 1:6){
 for(j in 1:6){
   x001<-cor(dtuea3[,i],dtuea3[,j])
   x002<-cor(dtuea3[,i],dtuea3[,j],method="spearman")
   cormatf[i,j]<-ifelse(i>=j,x001,x002)
 }
}

for(i in 1:6){
 for(j in 1:6){
  cormatf[i,j]<-round(cormatf[i,j],3)
 }
}

cormatfe<-cormatf

dtufa3<-as.data.frame(cbind.data.frame(dtufa$finunc1,dtufa$macunc1,dtufa$reaunc1,dtufa$msdf,dtufa$l11f2,dtufa$l12f2))

cormatf<-matrix(1,nrow=6,ncol=6)

for(i in 1:6){
 for(j in 1:6){
   x001<-cor(dtufa3[,i],dtufa3[,j])
   x002<-cor(dtufa3[,i],dtufa3[,j],method="spearman")
   cormatf[i,j]<-ifelse(i>=j,x001,x002)
 }
}

for(i in 1:6){
 for(j in 1:6){
  cormatf[i,j]<-round(cormatf[i,j],3)
 }
}

cormatff<-cormatf

cm1<-cbind(cormatfc,cormatfd) ### Place 1-month and 3-month next to each other
cm2<-cbind(cormatfe,cormatff) ### Place 6-month and 12-month results next to each other
cm3<-rbind(cm1,cm2) ### Stack to form the basis of Table 1

cm4<-rbind(cm3[4:6,],cm3[10:12,]) ### Focus only on the three rows which change with each point cloud lenght (volatility and persisistence norms) 

### Blank out the empty cells

cm4[1,5]<-""
cm4[1,6]<-""
cm4[1,11]<-""
cm4[1,12]<-""
cm4[2,6]<-""
cm4[2,12]<-""
cm4[4,5]<-""
cm4[4,6]<-""
cm4[4,11]<-""
cm4[4,12]<-""
cm4[5,6]<-""
cm4[5,12]<-""

### cm4 is Table 2 in the main paper

write.table(cm4,"Table2.csv",sep=",",row.names=FALSE) ### Output file into working directory for formatting

####################
# VIF calculations #
####################

# The following code collects all of the VIF for the models used in this paper
# To calculate the VIF it is necessary to have 2 or more dependent variables and so only Models 3 and 6 are considered

v001<-matrix(0,nrow=6,ncol=12) # For FIN
v002<-matrix(0,nrow=2,ncol=12) # For MAC only needs to consider when macunc is an independent variable
v003<-matrix(0,nrow=2,ncol=12) # For REAL also only needs to consider when reaunc is an independent variable

### Start with 1 month FIN

lm01<-lm(l11c2~finunc1+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~finunc1+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~finunc1+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~finunc1+msdf,data=dtufa) # 12 months L1 norm

lm11<-lm(finunc1~l11c2+msdc,data=dtuca) # 1 month L1 norm finunc
lm12<-lm(finunc1~l11d2+msdd,data=dtuda) # 3 month L1 norm finunc
lm13<-lm(finunc1~l11e2+msde,data=dtuea) # 6 month L1 norm finunc
lm14<-lm(finunc1~l11f2+msdf,data=dtufa) # 12 month L1 norm finunc

lm21<-lm(finunc1~l12c2+msdc,data=dtuca) # 1 month L2 norm finunc
lm22<-lm(finunc1~l12d2+msdd,data=dtuda) # 3 month L2 norm finunc
lm23<-lm(finunc1~l12e2+msde,data=dtuea) # 6 month L2 norm finunc
lm24<-lm(finunc1~l12f2+msdf,data=dtufa) # 12 month L2 norm finunc

v001[1,1]<-vif(lm01)[1] ### column 1 is based on the 1 months regression
v001[2,1]<-vif(lm01)[2]
v001[1,2]<-vif(lm02)[1] ### column 2 is based on the 3 months regression
v001[2,2]<-vif(lm02)[2]
v001[1,3]<-vif(lm03)[1] ### column 3 is based on the 6 months regression
v001[2,3]<-vif(lm03)[2]
v001[1,4]<-vif(lm04)[1] ### column 4 is based on the 12 months regression
v001[2,4]<-vif(lm04)[2]
v001[3,1]<-vif(lm11)[1] ### Now rows 3 and 4 with l11 as an independent variable
v001[4,1]<-vif(lm11)[2]
v001[3,2]<-vif(lm12)[1] 
v001[4,2]<-vif(lm12)[2]
v001[3,3]<-vif(lm13)[1] 
v001[4,3]<-vif(lm13)[2]
v001[3,4]<-vif(lm14)[1] 
v001[4,4]<-vif(lm14)[2]
v001[5,1]<-vif(lm21)[1] ### Finally rows 5 and 6 when l12 is an independent variable
v001[6,1]<-vif(lm21)[2]
v001[5,2]<-vif(lm22)[1] 
v001[6,2]<-vif(lm22)[2]
v001[5,3]<-vif(lm23)[1] 
v001[6,3]<-vif(lm23)[2]
v001[5,4]<-vif(lm24)[1] 
v001[6,4]<-vif(lm24)[2]

### Next is 3 month FIN

lm01<-lm(l11c2~finunc3+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~finunc3+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~finunc3+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~finunc3+msdf,data=dtufa) # 12 months L1 norm

lm11<-lm(finunc3~l11c2+msdc,data=dtuca) # 1 month L1 norm finunc
lm12<-lm(finunc3~l11d2+msdd,data=dtuda) # 3 months L1 norm finunc
lm13<-lm(finunc3~l11e2+msde,data=dtuea) # 6 months L1 norm finunc
lm14<-lm(finunc3~l11f2+msdf,data=dtufa) # 12 months L1 norm finunc

lm21<-lm(finunc3~l12c2+msdc,data=dtuca) # 1 month L2 norm finunc
lm22<-lm(finunc3~l12d2+msdd,data=dtuda) # 3 months L2 norm finunc
lm23<-lm(finunc3~l12e2+msde,data=dtuea) # 6 months L2 norm finunc
lm24<-lm(finunc3~l12f2+msdf,data=dtufa) # 12 months L2 norm finunc

v001[1,5]<-vif(lm01)[1] ### column 5 is based on the 1 months regression
v001[2,5]<-vif(lm01)[2]
v001[1,6]<-vif(lm02)[1] ### column 6 is based on the 3 months regression
v001[2,6]<-vif(lm02)[2]
v001[1,7]<-vif(lm03)[1] ### column 7 is based on the 6 months regression
v001[2,7]<-vif(lm03)[2]
v001[1,8]<-vif(lm04)[1] ### column 8 is based on the 12 months regression
v001[2,8]<-vif(lm04)[2]
v001[3,5]<-vif(lm11)[1] ### Now rows 3 and 4 with l11 as an independent variable
v001[4,5]<-vif(lm11)[2]
v001[3,6]<-vif(lm12)[1] 
v001[4,6]<-vif(lm12)[2]
v001[3,7]<-vif(lm13)[1] 
v001[4,7]<-vif(lm13)[2]
v001[3,8]<-vif(lm14)[1] 
v001[4,8]<-vif(lm14)[2]
v001[5,5]<-vif(lm21)[1] ### Finally rows 5 and 6 when l12 is an independent variable
v001[6,5]<-vif(lm21)[2]
v001[5,6]<-vif(lm22)[1] 
v001[6,6]<-vif(lm22)[2]
v001[5,7]<-vif(lm23)[1] 
v001[6,7]<-vif(lm23)[2]
v001[5,8]<-vif(lm24)[1] 
v001[6,8]<-vif(lm24)[2]

### Finally 12 month FIN

lm01<-lm(l11c2~finunc12+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~finunc12+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~finunc12+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~finunc12+msdf,data=dtufa) # 12 months L1 norm

lm11<-lm(finunc12~l11c2+msdc,data=dtuca) # 1 month L1 norm finunc
lm12<-lm(finunc12~l11d2+msdd,data=dtuda) # 3 month L1 norm finunc
lm13<-lm(finunc12~l11e2+msde,data=dtuea) # 6 month L1 norm finunc
lm14<-lm(finunc12~l11f2+msdf,data=dtufa) # 12 month L1 norm finunc

lm21<-lm(finunc12~l12c2+msdc,data=dtuca) # 1 month L2 norm finunc
lm22<-lm(finunc12~l12d2+msdd,data=dtuda) # 3 month L2 norm finunc
lm23<-lm(finunc12~l12e2+msde,data=dtuea) # 6 month L2 norm finunc
lm24<-lm(finunc12~l12f2+msdf,data=dtufa) # 12 month L2 norm finunc

v001[1,9]<-vif(lm01)[1] ### column 9 is based on the 1 months regression
v001[2,9]<-vif(lm01)[2]
v001[1,10]<-vif(lm02)[1] ### column 10 is based on the 3 months regression
v001[2,10]<-vif(lm02)[2]
v001[1,11]<-vif(lm03)[1] ### column 11 is based on the 6 months regression
v001[2,11]<-vif(lm03)[2]
v001[1,12]<-vif(lm04)[1] ### column 12 is based on the 12 months regression
v001[2,12]<-vif(lm04)[2]
v001[3,9]<-vif(lm11)[1] ### Now rows 3 and 4 with l11 as an independent variable
v001[4,9]<-vif(lm11)[2]
v001[3,10]<-vif(lm12)[1] 
v001[4,10]<-vif(lm12)[2]
v001[3,11]<-vif(lm13)[1] 
v001[4,11]<-vif(lm13)[2]
v001[3,12]<-vif(lm14)[1] 
v001[4,12]<-vif(lm14)[2]
v001[5,9]<-vif(lm21)[1] ### Finally rows 5 and 6 when l12 is an independent variable
v001[6,9]<-vif(lm21)[2]
v001[5,10]<-vif(lm22)[1] 
v001[6,10]<-vif(lm22)[2]
v001[5,11]<-vif(lm23)[1] 
v001[6,11]<-vif(lm23)[2]
v001[5,12]<-vif(lm24)[1] 
v001[6,12]<-vif(lm24)[2]

### Start with 1 month MAC

lm01<-lm(l11c2~macunc1+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~macunc1+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~macunc1+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~macunc1+msdf,data=dtufa) # 12 months L1 norm


v002[1,1]<-vif(lm01)[1] ### column 1 is based on the 1 months regression
v002[2,1]<-vif(lm01)[2]
v002[1,2]<-vif(lm02)[1] ### column 2 is based on the 3 months regression
v002[2,2]<-vif(lm02)[2]
v002[1,3]<-vif(lm03)[1] ### column 3 is based on the 6 months regression
v002[2,3]<-vif(lm03)[2]
v002[1,4]<-vif(lm04)[1] ### column 4 is based on the 12 months regression
v002[2,4]<-vif(lm04)[2]

### Next is 3 month MAC

lm01<-lm(l11c2~macunc3+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~macunc3+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~macunc3+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~macunc3+msdf,data=dtufa) # 12 months L1 norm

v002[1,5]<-vif(lm01)[1] ### column 5 is based on the 1 months regression
v002[2,5]<-vif(lm01)[2]
v002[1,6]<-vif(lm02)[1] ### column 6 is based on the 3 months regression
v002[2,6]<-vif(lm02)[2]
v002[1,7]<-vif(lm03)[1] ### column 7 is based on the 6 months regression
v002[2,7]<-vif(lm03)[2]
v002[1,8]<-vif(lm04)[1] ### column 8 is based on the 12 months regression
v002[2,8]<-vif(lm04)[2]


### Finally 12 month MAC

lm01<-lm(l11c2~macunc12+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~macunc12+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~macunc12+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~macunc12+msdf,data=dtufa) # 12 months L1 norm

v002[1,9]<-vif(lm01)[1] ### column 9 is based on the 1 months regression
v002[2,9]<-vif(lm01)[2]
v002[1,10]<-vif(lm02)[1] ### column 10 is based on the 3 months regression
v002[2,10]<-vif(lm02)[2]
v002[1,11]<-vif(lm03)[1] ### column 11 is based on the 6 months regression
v002[2,11]<-vif(lm03)[2]
v002[1,12]<-vif(lm04)[1] ### column 12 is based on the 12 months regression
v002[2,12]<-vif(lm04)[2]

### Start with 1 month REAL

lm01<-lm(l11c2~reaunc1+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~reaunc1+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~reaunc1+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~reaunc1+msdf,data=dtufa) # 12 months L1 norm


v003[1,1]<-vif(lm01)[1] ### column 1 is based on the 1 months regression
v003[2,1]<-vif(lm01)[2]
v003[1,2]<-vif(lm02)[1] ### column 2 is based on the 3 months regression
v003[2,2]<-vif(lm02)[2]
v003[1,3]<-vif(lm03)[1] ### column 3 is based on the 6 months regression
v003[2,3]<-vif(lm03)[2]
v003[1,4]<-vif(lm04)[1] ### column 4 is based on the 12 months regression
v003[2,4]<-vif(lm04)[2]

### Next is 3 month REAL

lm01<-lm(l11c2~reaunc3+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~reaunc3+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~reaunc3+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~reaunc3+msdf,data=dtufa) # 12 months L1 norm

v003[1,5]<-vif(lm01)[1] ### column 5 is based on the 1 months regression
v003[2,5]<-vif(lm01)[2]
v003[1,6]<-vif(lm02)[1] ### column 6 is based on the 3 months regression
v003[2,6]<-vif(lm02)[2]
v003[1,7]<-vif(lm03)[1] ### column 7 is based on the 6 months regression
v003[2,7]<-vif(lm03)[2]
v003[1,8]<-vif(lm04)[1] ### column 8 is based on the 12 months regression
v003[2,8]<-vif(lm04)[2]


### Finally 12 month REAL

lm01<-lm(l11c2~reaunc12+msdc,data=dtuca) # 1 month L1 norm
lm02<-lm(l11d2~reaunc12+msdd,data=dtuda) # 3 months L1 norm
lm03<-lm(l11e2~reaunc12+msde,data=dtuea) # 6 months L1 norm
lm04<-lm(l11f2~reaunc12+msdf,data=dtufa) # 12 months L1 norm

v003[1,9]<-vif(lm01)[1] ### column 9 is based on the 1 months regression
v003[2,9]<-vif(lm01)[2]
v003[1,10]<-vif(lm02)[1] ### column 10 is based on the 3 months regression
v003[2,10]<-vif(lm02)[2]
v003[1,11]<-vif(lm03)[1] ### column 11 is based on the 6 months regression
v003[2,11]<-vif(lm03)[2]
v003[1,12]<-vif(lm04)[1] ### column 12 is based on the 12 months regression
v003[2,12]<-vif(lm04)[2]

v004<-rbind(v001[1:2,],v002,v003,v001[3:6,])

v004<-round(v004,3)

write.table(v004,"viftable.csv",sep=",",row.names=FALSE) ### This table is available on request, but values are referred to in the text.





#############################################################################################
# Figure 1 is produced using the following code. You may substitute in the names based on the different clouds and variables #
#############################################################################################

### First we normalise the variables

dtuca$l11c2n<-(dtuca$l11c2-mean(dtuca$l11c2))/sd(dtuca$l11c2)
dtuda$l11d2n<-(dtuda$l11d2-mean(dtuda$l11d2))/sd(dtuda$l11d2)
dtuea$l11e2n<-(dtuea$l11e2-mean(dtuea$l11e2))/sd(dtuea$l11e2)
dtufa$l11f2n<-(dtufa$l11f2-mean(dtufa$l11f2))/sd(dtufa$l11f2)

dtuca$l12c2n<-(dtuca$l12c2-mean(dtuca$l12c2))/sd(dtuca$l12c2)
dtuda$l12d2n<-(dtuda$l12d2-mean(dtuda$l12d2))/sd(dtuda$l12d2)
dtuea$l12e2n<-(dtuea$l12e2-mean(dtuea$l12e2))/sd(dtuea$l12e2)
dtufa$l12f2n<-(dtufa$l12f2-mean(dtufa$l12f2))/sd(dtufa$l12f2)

dtuca$msdcn<-(dtuca$msdc-mean(dtuca$msdc))/sd(dtuca$msdc)
dtuda$msddn<-(dtuda$msdd-mean(dtuda$msdd))/sd(dtuda$msdd)
dtuea$msden<-(dtuea$msde-mean(dtuea$msde))/sd(dtuea$msde)
dtufa$msdfn<-(dtufa$msdf-mean(dtufa$msdf))/sd(dtufa$msdf)

dtuca$finunc1n<-(dtuca$finunc1-mean(dtuca$finunc1))/sd(dtuca$finunc1)
dtuda$finunc1n<-(dtuda$finunc1-mean(dtuda$finunc1))/sd(dtuda$finunc1)
dtuea$finunc1n<-(dtuea$finunc1-mean(dtuea$finunc1))/sd(dtuea$finunc1)
dtufa$finunc1n<-(dtufa$finunc1-mean(dtufa$finunc1))/sd(dtufa$finunc1)

dtuca$macunc1n<-(dtuca$macunc1-mean(dtuca$macunc1))/sd(dtuca$macunc1)
dtuda$macunc1n<-(dtuda$macunc1-mean(dtuda$macunc1))/sd(dtuda$macunc1)
dtuea$macunc1n<-(dtuea$macunc1-mean(dtuea$macunc1))/sd(dtuea$macunc1)
dtufa$macunc1n<-(dtufa$macunc1-mean(dtufa$macunc1))/sd(dtufa$macunc1)

#### Let us save these again

save.dta13(dtuca,"dtuca2005222.dta")
save.dta13(dtuda,"dtuda2005222.dta")
save.dta13(dtuea,"dtuea2005222.dta")
save.dta13(dtufa,"dtufa2005222.dta")


#### We may now use these normalised series to plot the graphs
#### The code is repeated to first produce basic images for on screen viewing and then to produce high resolution images

length1<-2400/72
length2<-1200/72

### Panel (a) Financial Uncertainty - 3 month cloud

png("dtudafinunc1l11.png",width=1200,height=600)
plot(dtuda$dt.y,dtuda$msddn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtuda$dt.y,dtuda$msddn,lwd=3) ### Plot volatility
lines(dtuda$dt.y,dtuda$l11d2n,col="red",lwd=3) ### l11 norm
lines(dtuda$dt.y,dtuda$finunc1n,col="blue",lwd=3) 
leg.text=c("Volatility","L1 norm", "Financial uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"))
dev.off()

png("dtudafinunc1l11hr.png",res=600,width=length1,height=length2,units="in")
par(cex.axis=3,cex.lab=3,mar=c(6,5.5,4.1,2.1))
plot(dtuda$dt.y,dtuda$msddn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtuda$dt.y,dtuda$msddn,lwd=6) ### Plot volatility
lines(dtuda$dt.y,dtuda$l11d2n,col="red",lwd=6) ### l11 norm
lines(dtuda$dt.y,dtuda$finunc1n,col="blue",lwd=6) 
leg.text=c("Volatility","L1 norm", "FIN1")
legend("topleft",leg.text,lwd=c(3,3,3),col=c("black","red","blue"),cex=6)
dev.off()

### Panel (b) Financial Uncertainty - 12 month cloud

png("dtufafinunc1l11.png",width=1200,height=600)
plot(dtufa$dt.y,dtufa$msdfn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value")
lines(dtufa$dt.y,dtufa$msdfn,lwd=3)
lines(dtufa$dt.y,dtufa$l11f2n,col="red",lwd=3)
lines(dtufa$dt.y,dtufa$finunc1n,col="blue",lwd=3)
leg.text=c("Volatility","L1 norm", "Financial uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"))
dev.off()

png("dtufafinunc1l11hr.png",res=600,width=length1,height=length2,units="in")
par(cex.axis=3,cex.lab=3,mar=c(6,5.5,4.1,2.1))
plot(dtufa$dt.y,dtufa$msdfn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtufa$dt.y,dtufa$msdfn,lwd=6) ### Plot volatility
lines(dtufa$dt.y,dtufa$l11f2n,col="red",lwd=6) ### l11 norm
lines(dtufa$dt.y,dtufa$finunc1n,col="blue",lwd=6) 
leg.text=c("Volatility","L1 norm", "FIN1")
legend("topleft",leg.text,lwd=c(3,3,3),col=c("black","red","blue"),cex=6)
dev.off()


### Panel (c)

png("dtudamacunc1l11.png",width=1200,height=600)
plot(dtuda$dt.y,dtuda$msddn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtuda$dt.y,dtuda$msddn,lwd=3) ### Plot volatility
lines(dtuda$dt.y,dtuda$l11d2n,col="red",lwd=3) ### l11 norm
lines(dtuda$dt.y,dtuda$macunc1n,col="blue",lwd=3) 
leg.text=c("Volatility","L1 norm", "Macroeconomic uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"))
dev.off()

png("dtudamacunc1l11hr.png",res=600,width=length1,height=length2,units="in")
par(cex.axis=3,cex.lab=3,mar=c(6,5.5,4.1,2.1))
plot(dtuda$dt.y,dtuda$msddn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtuda$dt.y,dtuda$msddn,lwd=6) ### Plot volatility
lines(dtuda$dt.y,dtuda$l11d2n,col="red",lwd=6) ### l11 norm
lines(dtuda$dt.y,dtuda$macunc1n,col="blue",lwd=6) 
leg.text=c("Volatility","L1 norm", "MAC1")
legend("topleft",leg.text,lwd=c(3,3,3),col=c("black","red","blue"),cex=6)
dev.off()


### Panel (d)

png("dtufamacunc1l11.png",width=1200,height=600)
plot(dtufa$dt.y,dtufa$msdfn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtufa$dt.y,dtufa$msdfn,lwd=3) ### Plot volatility
lines(dtufa$dt.y,dtufa$l11f2n,col="red",lwd=3) ### l11 norm
lines(dtufa$dt.y,dtufa$macunc1n,col="blue",lwd=3) 
leg.text=c("Volatility","L1 norm", "Macroeconomic uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"),cex=6)
dev.off()

png("dtufamacunc1l11hr.png",res=600,width=length1,height=length2,units="in")
par(cex.axis=3,cex.lab=3,mar=c(6,5.5,4.1,2.1))
plot(dtufa$dt.y,dtufa$msdfn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtufa$dt.y,dtufa$msdfn,lwd=6) ### Plot volatility
lines(dtufa$dt.y,dtufa$l11f2n,col="red",lwd=6) ### l11 norm
lines(dtufa$dt.y,dtufa$macunc1n,col="blue",lwd=6) 
leg.text=c("Volatility","L1 norm", "MAC1")
legend("topleft",leg.text,lwd=c(3,3,3),col=c("black","red","blue"),cex=6)
dev.off()


###################################################################
# Figure A2 includes the same four plots plus the same 4 but with L2 norms in place of L1 	#
#											#
# The following code can be used for the four panels of Figure A2 not yet produced	#
###################################################################

### Panel (a) Financial Uncertainty - 3 month cloud

png("dtudafinunc1l12.png",width=1200,height=600)
plot(dtuda$dt.y,dtuda$msddn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtuda$dt.y,dtuda$msddn,lwd=3) ### Plot volatility
lines(dtuda$dt.y,dtuda$l12d2n,col="red",lwd=3) ### l12 norm
lines(dtuda$dt.y,dtuda$finunc1n,col="blue",lwd=3) 
leg.text=c("Volatility","L2 norm", "Financial uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"))
dev.off()

### Panel (b) Financial Uncertainty - 12 month cloud

png("dtufafinunc1l12.png",width=1200,height=600)
plot(dtufa$dt.y,dtufa$msdfn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value")
lines(dtufa$dt.y,dtufa$msdfn,lwd=3)
lines(dtufa$dt.y,dtufa$l12f2n,col="red",lwd=3)
lines(dtufa$dt.y,dtufa$finunc1n,col="blue",lwd=3)
leg.text=c("Volatility","L2 norm", "Financial uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"))
dev.off()

### Panel (e)

png("dtudamacunc1l12.png",width=1200,height=600)
plot(dtuda$dt.y,dtuda$msddn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtuda$dt.y,dtuda$msddn,lwd=3) ### Plot volatility
lines(dtuda$dt.y,dtuda$l12d2n,col="red",lwd=3) ### l12 norm
lines(dtuda$dt.y,dtuda$macunc1n,col="blue",lwd=3) 
leg.text=c("Volatility","L2 norm", "Macroeconomic uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"))
dev.off()

### Panel (f)

png("dtufamacunc1l12.png",width=1200,height=600)
plot(dtufa$dt.y,dtufa$msdfn,type="l",ylim=c(-2,5),xlab="Date",ylab="Value") ### Set axis with parameters in paper
lines(dtufa$dt.y,dtufa$msdfn,lwd=3) ### Plot volatility
lines(dtufa$dt.y,dtufa$l12f2n,col="red",lwd=3) ### l12 norm
lines(dtufa$dt.y,dtufa$macunc1n,col="blue",lwd=3) 
leg.text=c("Volatility","L2 norm", "Macroeconomic uncertainty - 1 Month")
legend("topleft",leg.text,lwd=c(3,3,3,"dotted"),col=c("black","red","blue"))
dev.off()

### Panels (c) (d) (g) and (h) are panels (a) (b) (c) and (d) from Figure 1 of the main paper

#############################################################
# Table 2 presents regressions for the L11 norms based on models 1 to 3 	#
# Models are fitted with Newey-West adjusted standard errors			#
# Note that the code for the table includes 0 in the cells that are blanked out in   	#
# the main paper. It is left to the user to format the tables themselves		#
#############################################################

cf201<-coeftest(lm(l11c2~finunc1,data=dtuca),vcov=NeweyWest(lm(l11c2~finunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just finunc1 as explanatory. This is model 1
sm201<-summary(lm(l11c2~finunc1,data=dtuca))
cf202<-coeftest(lm(l11d2~finunc1,data=dtuda),vcov=NeweyWest(lm(l11d2~finunc1,data=dtuda),lag=6))
sm202<-summary(lm(l11d2~finunc1,data=dtuda))
cf203<-coeftest(lm(l11e2~finunc1,data=dtuea),vcov=NeweyWest(lm(l11e2~finunc1,data=dtuea),lag=6))
sm203<-summary(lm(l11e2~finunc1,data=dtuea))
cf204<-coeftest(lm(l11f2~finunc1,data=dtufa),vcov=NeweyWest(lm(l11f2~finunc1,data=dtufa),lag=6))
sm204<-summary(lm(l11f2~finunc1,data=dtufa))

ch201<-coeftest(lm(l11c2~msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l11c2~msdc,data=dtuca))
ch202<-coeftest(lm(l11d2~msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l11d2~msdd,data=dtuda))
ch203<-coeftest(lm(l11e2~msde,data=dtuea),vcov=NeweyWest(lm(l11e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l11e2~msde,data=dtuea))
ch204<-coeftest(lm(l11f2~msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l11f2~msdf,data=dtufa))

cg201<-coeftest(lm(l11c2~finunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~finunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l11c2~finunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l11d2~finunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~finunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l11d2~finunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l11e2~finunc1+msde,data=dtuea),vcov=NeweyWest(lm(l11e2~finunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l11e2~finunc1+msde,data=dtuea))
cg204<-coeftest(lm(l11f2~finunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~finunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l11f2~finunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### coefficients 

rtab201[3,1]<-round(cf201[2,1],3) ### finunc1 for model 1
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3) ### Volatility for model 2
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3) ### finunc1 for model 3
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3) ### Volatility for model 3
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Now add t-statistics

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")

### Finally add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201f1<-rtab201 ### store

#### rtab201f1  is the raw panel (a) of Table 2 from the main paper

cf201<-coeftest(lm(l11c2~macunc1,data=dtuca),vcov=NeweyWest(lm(l11c2~macunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just macunc1 as explanatory. This is model 1
sm201<-summary(lm(l11c2~macunc1,data=dtuca))
cf202<-coeftest(lm(l11d2~macunc1,data=dtuda),vcov=NeweyWest(lm(l11d2~macunc1,data=dtuda),lag=6))
sm202<-summary(lm(l11d2~macunc1,data=dtuda))
cf203<-coeftest(lm(l11e2~macunc1,data=dtuea),vcov=NeweyWest(lm(l11e2~macunc1,data=dtuea),lag=6))
sm203<-summary(lm(l11e2~macunc1,data=dtuea))
cf204<-coeftest(lm(l11f2~macunc1,data=dtufa),vcov=NeweyWest(lm(l11f2~macunc1,data=dtufa),lag=6))
sm204<-summary(lm(l11f2~macunc1,data=dtufa))

ch201<-coeftest(lm(l11c2~msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l11c2~msdc,data=dtuca))
ch202<-coeftest(lm(l11d2~msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l11d2~msdd,data=dtuda))
ch203<-coeftest(lm(l11e2~msde,data=dtuea),vcov=NeweyWest(lm(l11e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l11e2~msde,data=dtuea))
ch204<-coeftest(lm(l11f2~msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l11f2~msdf,data=dtufa))

cg201<-coeftest(lm(l11c2~macunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~macunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l11c2~macunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l11d2~macunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~macunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l11d2~macunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l11e2~macunc1+msde,data=dtuea),vcov=NeweyWest(lm(l11e2~macunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l11e2~macunc1+msde,data=dtuea))
cg204<-coeftest(lm(l11f2~macunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~macunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l11f2~macunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### coefficients 

rtab201[3,1]<-round(cf201[2,1],3) ### macunc1 for model 1
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3) ### Volatility for model 2
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3) ### macunc1 for model 3
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3) ### Volatility for model 3
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Now add t-statistics

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")

### macally add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201m1<-rtab201

#### rtab201m1 is the raw panel (b) of Table 2 from the main paper

table3<-rbind(rtab201f1,rtab201m1)

write.table(table3,"Table3.csv",sep=",",row.names=FALSE) ### Output file into working directory for formatting
latout(table3,"Table3.txt")

#########################################################
# This code produces a version with significance stars 	#
#########################################################

cf201<-coeftest(lm(l11c2~finunc1,data=dtuca),vcov=NeweyWest(lm(l11c2~finunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just finunc1 as explanatory. This is model 1
sm201<-summary(lm(l11c2~finunc1,data=dtuca))
cf202<-coeftest(lm(l11d2~finunc1,data=dtuda),vcov=NeweyWest(lm(l11d2~finunc1,data=dtuda),lag=6))
sm202<-summary(lm(l11d2~finunc1,data=dtuda))
cf203<-coeftest(lm(l11e2~finunc1,data=dtuea),vcov=NeweyWest(lm(l11e2~finunc1,data=dtuea),lag=6))
sm203<-summary(lm(l11e2~finunc1,data=dtuea))
cf204<-coeftest(lm(l11f2~finunc1,data=dtufa),vcov=NeweyWest(lm(l11f2~finunc1,data=dtufa),lag=6))
sm204<-summary(lm(l11f2~finunc1,data=dtufa))

ch201<-coeftest(lm(l11c2~msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l11c2~msdc,data=dtuca))
ch202<-coeftest(lm(l11d2~msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l11d2~msdd,data=dtuda))
ch203<-coeftest(lm(l11e2~msde,data=dtuea),vcov=NeweyWest(lm(l11e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l11e2~msde,data=dtuea))
ch204<-coeftest(lm(l11f2~msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l11f2~msdf,data=dtufa))

cg201<-coeftest(lm(l11c2~finunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~finunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l11c2~finunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l11d2~finunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~finunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l11d2~finunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l11e2~finunc1+msde,data=dtuea),vcov=NeweyWest(lm(l11e2~finunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l11e2~finunc1+msde,data=dtuea))
cg204<-coeftest(lm(l11f2~finunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~finunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l11f2~finunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 


rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")

### Finally add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201f1<-rtab201 ### store

#### rtab201f1  is the raw panel (a) of Table 2 from the main paper with significance stars

cf201<-coeftest(lm(l11c2~macunc1,data=dtuca),vcov=NeweyWest(lm(l11c2~macunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just macunc1 as explanatory. This is model 1
sm201<-summary(lm(l11c2~macunc1,data=dtuca))
cf202<-coeftest(lm(l11d2~macunc1,data=dtuda),vcov=NeweyWest(lm(l11d2~macunc1,data=dtuda),lag=6))
sm202<-summary(lm(l11d2~macunc1,data=dtuda))
cf203<-coeftest(lm(l11e2~macunc1,data=dtuea),vcov=NeweyWest(lm(l11e2~macunc1,data=dtuea),lag=6))
sm203<-summary(lm(l11e2~macunc1,data=dtuea))
cf204<-coeftest(lm(l11f2~macunc1,data=dtufa),vcov=NeweyWest(lm(l11f2~macunc1,data=dtufa),lag=6))
sm204<-summary(lm(l11f2~macunc1,data=dtufa))

ch201<-coeftest(lm(l11c2~msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l11c2~msdc,data=dtuca))
ch202<-coeftest(lm(l11d2~msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l11d2~msdd,data=dtuda))
ch203<-coeftest(lm(l11e2~msde,data=dtuea),vcov=NeweyWest(lm(l11e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l11e2~msde,data=dtuea))
ch204<-coeftest(lm(l11f2~msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l11f2~msdf,data=dtufa))

cg201<-coeftest(lm(l11c2~macunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l11c2~macunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l11c2~macunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l11d2~macunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l11d2~macunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l11d2~macunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l11e2~macunc1+msde,data=dtuea),vcov=NeweyWest(lm(l11e2~macunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l11e2~macunc1+msde,data=dtuea))
cg204<-coeftest(lm(l11f2~macunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l11f2~macunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l11f2~macunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)


### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")

### manually add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201m1<-rtab201

#### rtab201m1 is the raw panel (b) of Table 2 from the main paper

table3s<-rbind(rtab201f1,rtab201m1)

write.table(table3s,"Table3star.csv",sep=",",row.names=FALSE) ### Output file into working directory for formatting
latout(table3s,"Table3star.txt")

# For this table the standard errors are allowed to be negative. You may delete the minus signs in the formatting to produce a version with absolute standard errors.

#############################################################
# Next we estimate Models 4 5 and 6 with uncertainty as the dependent variable	#
#										#
# This will produce Table 3 of the main paper					#
#############################################################


cf201<-coeftest(lm(finunc1~l11c2,data=dtuca),vcov=NeweyWest(lm(finunc1~l11c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(finunc1~l11c2,data=dtuca))
cf202<-coeftest(lm(finunc1~l11d2,data=dtuda),vcov=NeweyWest(lm(finunc1~l11d2,data=dtuda),lag=6))
sm202<-summary(lm(finunc1~l11d2,data=dtuda))
cf203<-coeftest(lm(finunc1~l11e2,data=dtuea),vcov=NeweyWest(lm(finunc1~l11e2,data=dtuea),lag=6))
sm203<-summary(lm(finunc1~l11e2,data=dtuea))
cf204<-coeftest(lm(finunc1~l11f2,data=dtufa),vcov=NeweyWest(lm(finunc1~l11f2,data=dtufa),lag=6))
sm204<-summary(lm(finunc1~l11f2,data=dtufa))

ch201<-coeftest(lm(finunc1~msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(finunc1~msdc,data=dtuca))
ch202<-coeftest(lm(finunc1~msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtuda))
ch203<-coeftest(lm(finunc1~msde,data=dtuea),vcov=NeweyWest(lm(finunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(finunc1~msde,data=dtuea))
ch204<-coeftest(lm(finunc1~msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufa))

cg201<-coeftest(lm(finunc1~l11c2+msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~l11c2+msdc,data=dtuca),lag=6)) ### Then finally model 6
sn201<-summary(lm(finunc1~l11c2+msdc,data=dtuca))
cg202<-coeftest(lm(finunc1~l11d2+msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~l11d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(finunc1~l11d2+msdd,data=dtuda))
cg203<-coeftest(lm(finunc1~l11e2+msde,data=dtuea),vcov=NeweyWest(lm(finunc1~l11e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(finunc1~l11e2+msde,data=dtuea))
cg204<-coeftest(lm(finunc1~l11f2+msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~l11f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(finunc1~l11f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### Add coefficients

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Add t-statistics in parentheses

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3f<-rtab201 ### store for later

#### Now compute panel (b) with macunc1

cf201<-coeftest(lm(macunc1~l11c2,data=dtuca),vcov=NeweyWest(lm(macunc1~l11c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(macunc1~l11c2,data=dtuca))
cf202<-coeftest(lm(macunc1~l11d2,data=dtuda),vcov=NeweyWest(lm(macunc1~l11d2,data=dtuda),lag=6))
sm202<-summary(lm(macunc1~l11d2,data=dtuda))
cf203<-coeftest(lm(macunc1~l11e2,data=dtuea),vcov=NeweyWest(lm(macunc1~l11e2,data=dtuea),lag=6))
sm203<-summary(lm(macunc1~l11e2,data=dtuea))
cf204<-coeftest(lm(macunc1~l11f2,data=dtufa),vcov=NeweyWest(lm(macunc1~l11f2,data=dtufa),lag=6))
sm204<-summary(lm(macunc1~l11f2,data=dtufa))

ch201<-coeftest(lm(macunc1~msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(macunc1~msdc,data=dtuca))
ch202<-coeftest(lm(macunc1~msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtuda))
ch203<-coeftest(lm(macunc1~msde,data=dtuea),vcov=NeweyWest(lm(macunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(macunc1~msde,data=dtuea))
ch204<-coeftest(lm(macunc1~msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufa))

cg201<-coeftest(lm(macunc1~l11c2+msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~l11c2+msdc,data=dtuca),lag=6)) ### Then macally model 6
sn201<-summary(lm(macunc1~l11c2+msdc,data=dtuca))
cg202<-coeftest(lm(macunc1~l11d2+msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~l11d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(macunc1~l11d2+msdd,data=dtuda))
cg203<-coeftest(lm(macunc1~l11e2+msde,data=dtuea),vcov=NeweyWest(lm(macunc1~l11e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(macunc1~l11e2+msde,data=dtuea))
cg204<-coeftest(lm(macunc1~l11f2+msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~l11f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(macunc1~l11f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### Add coefficients

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Add t-statistics in parentheses

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3m<-rtab201 ### store for later

### combine

table4<-rbind(rtab201t3f,rtab201t3m)

write.table(table4,"Table4.csv",sep=",",row.names=FALSE)
latout(table4,"Table4.txt")

#############################################################
# Repeating the estimation of Table 4 with stars	#
#############################################################


cf201<-coeftest(lm(finunc1~l11c2,data=dtuca),vcov=NeweyWest(lm(finunc1~l11c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(finunc1~l11c2,data=dtuca))
cf202<-coeftest(lm(finunc1~l11d2,data=dtuda),vcov=NeweyWest(lm(finunc1~l11d2,data=dtuda),lag=6))
sm202<-summary(lm(finunc1~l11d2,data=dtuda))
cf203<-coeftest(lm(finunc1~l11e2,data=dtuea),vcov=NeweyWest(lm(finunc1~l11e2,data=dtuea),lag=6))
sm203<-summary(lm(finunc1~l11e2,data=dtuea))
cf204<-coeftest(lm(finunc1~l11f2,data=dtufa),vcov=NeweyWest(lm(finunc1~l11f2,data=dtufa),lag=6))
sm204<-summary(lm(finunc1~l11f2,data=dtufa))

ch201<-coeftest(lm(finunc1~msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(finunc1~msdc,data=dtuca))
ch202<-coeftest(lm(finunc1~msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtuda))
ch203<-coeftest(lm(finunc1~msde,data=dtuea),vcov=NeweyWest(lm(finunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(finunc1~msde,data=dtuea))
ch204<-coeftest(lm(finunc1~msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufa))

cg201<-coeftest(lm(finunc1~l11c2+msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~l11c2+msdc,data=dtuca),lag=6)) ### Then finally model 6
sn201<-summary(lm(finunc1~l11c2+msdc,data=dtuca))
cg202<-coeftest(lm(finunc1~l11d2+msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~l11d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(finunc1~l11d2+msdd,data=dtuda))
cg203<-coeftest(lm(finunc1~l11e2+msde,data=dtuea),vcov=NeweyWest(lm(finunc1~l11e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(finunc1~l11e2+msde,data=dtuea))
cg204<-coeftest(lm(finunc1~l11f2+msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~l11f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(finunc1~l11f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)


### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3f<-rtab201 ### store for later

#### Now compute panel (b) with macunc1

cf201<-coeftest(lm(macunc1~l11c2,data=dtuca),vcov=NeweyWest(lm(macunc1~l11c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(macunc1~l11c2,data=dtuca))
cf202<-coeftest(lm(macunc1~l11d2,data=dtuda),vcov=NeweyWest(lm(macunc1~l11d2,data=dtuda),lag=6))
sm202<-summary(lm(macunc1~l11d2,data=dtuda))
cf203<-coeftest(lm(macunc1~l11e2,data=dtuea),vcov=NeweyWest(lm(macunc1~l11e2,data=dtuea),lag=6))
sm203<-summary(lm(macunc1~l11e2,data=dtuea))
cf204<-coeftest(lm(macunc1~l11f2,data=dtufa),vcov=NeweyWest(lm(macunc1~l11f2,data=dtufa),lag=6))
sm204<-summary(lm(macunc1~l11f2,data=dtufa))

ch201<-coeftest(lm(macunc1~msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(macunc1~msdc,data=dtuca))
ch202<-coeftest(lm(macunc1~msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtuda))
ch203<-coeftest(lm(macunc1~msde,data=dtuea),vcov=NeweyWest(lm(macunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(macunc1~msde,data=dtuea))
ch204<-coeftest(lm(macunc1~msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufa))

cg201<-coeftest(lm(macunc1~l11c2+msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~l11c2+msdc,data=dtuca),lag=6)) ### Then macally model 6
sn201<-summary(lm(macunc1~l11c2+msdc,data=dtuca))
cg202<-coeftest(lm(macunc1~l11d2+msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~l11d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(macunc1~l11d2+msdd,data=dtuda))
cg203<-coeftest(lm(macunc1~l11e2+msde,data=dtuea),vcov=NeweyWest(lm(macunc1~l11e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(macunc1~l11e2+msde,data=dtuea))
cg204<-coeftest(lm(macunc1~l11f2+msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~l11f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(macunc1~l11f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3m<-rtab201 ### store for later

### combine

table4s<-rbind(rtab201t3f,rtab201t3m)

write.table(table4s,"Table4star.csv",sep=",",row.names=FALSE)
latout(table4s,"Table4star.txt")

#######################################################
#  We then consider periods of high and low uncertainty as Table 5	#
#									#
#  In order to achieve this we must first split the sample on finunc1	#
#######################################################

dtucal<-subset(dtuca,dtuca$finunc1<=quantile(dtuca$finunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$finunc1<=quantile(dtuda$finunc1,0.5))
dtueal<-subset(dtuea,dtuea$finunc1<=quantile(dtuea$finunc1,0.5))
dtufal<-subset(dtufa,dtufa$finunc1<=quantile(dtufa$finunc1,0.5))
dtucah<-subset(dtuca,dtuca$finunc1>quantile(dtuca$finunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$finunc1>quantile(dtuda$finunc1,0.5))
dtueah<-subset(dtuea,dtuea$finunc1>quantile(dtuea$finunc1,0.5))
dtufah<-subset(dtufa,dtufa$finunc1>quantile(dtufa$finunc1,0.5))

### First look at the high uncertainty sample for Panel (a) of Table A3

cf201<-coeftest(lm(finunc1~l11c2,data=dtucah),vcov=NeweyWest(lm(finunc1~l11c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(finunc1~l11c2,data=dtucah))
cf202<-coeftest(lm(finunc1~l11d2,data=dtudah),vcov=NeweyWest(lm(finunc1~l11d2,data=dtudah),lag=6))
sm202<-summary(lm(finunc1~l11d2,data=dtudah))
cf203<-coeftest(lm(finunc1~l11e2,data=dtueah),vcov=NeweyWest(lm(finunc1~l11e2,data=dtueah),lag=6))
sm203<-summary(lm(finunc1~l11e2,data=dtueah))
cf204<-coeftest(lm(finunc1~l11f2,data=dtufah),vcov=NeweyWest(lm(finunc1~l11f2,data=dtufah),lag=6))
sm204<-summary(lm(finunc1~l11f2,data=dtufah))
cg201<-coeftest(lm(finunc1~l11c2+msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~l11c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(finunc1~l11c2+msdc,data=dtucah))
cg202<-coeftest(lm(finunc1~l11d2+msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~l11d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(finunc1~l11d2+msdd,data=dtudah))
cg203<-coeftest(lm(finunc1~l11e2+msde,data=dtueah),vcov=NeweyWest(lm(finunc1~l11e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(finunc1~l11e2+msde,data=dtueah))
cg204<-coeftest(lm(finunc1~l11f2+msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~l11f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(finunc1~l11f2+msdf,data=dtufah))
ch201<-coeftest(lm(finunc1~msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucah))
ch202<-coeftest(lm(finunc1~msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudah))
ch203<-coeftest(lm(finunc1~msde,data=dtueah),vcov=NeweyWest(lm(finunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueah))
ch204<-coeftest(lm(finunc1~msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(finunc1~l11c2,data=dtucal),vcov=NeweyWest(lm(finunc1~l11c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(finunc1~l11c2,data=dtucal))
cf202<-coeftest(lm(finunc1~l11d2,data=dtudal),vcov=NeweyWest(lm(finunc1~l11d2,data=dtudal),lag=6))
sm202<-summary(lm(finunc1~l11d2,data=dtudal))
cf203<-coeftest(lm(finunc1~l11e2,data=dtueal),vcov=NeweyWest(lm(finunc1~l11e2,data=dtueal),lag=6))
sm203<-summary(lm(finunc1~l11e2,data=dtueal))
cf204<-coeftest(lm(finunc1~l11f2,data=dtufal),vcov=NeweyWest(lm(finunc1~l11f2,data=dtufal),lag=6))
sm204<-summary(lm(finunc1~l11f2,data=dtufal))
cg201<-coeftest(lm(finunc1~l11c2+msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~l11c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(finunc1~l11c2+msdc,data=dtucal))
cg202<-coeftest(lm(finunc1~l11d2+msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~l11d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(finunc1~l11d2+msdd,data=dtudal))
cg203<-coeftest(lm(finunc1~l11e2+msde,data=dtueal),vcov=NeweyWest(lm(finunc1~l11e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(finunc1~l11e2+msde,data=dtueal))
cg204<-coeftest(lm(finunc1~l11f2+msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~l11f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(finunc1~l11f2+msdf,data=dtufal))
ch201<-coeftest(lm(finunc1~msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucal))
ch202<-coeftest(lm(finunc1~msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudal))
ch203<-coeftest(lm(finunc1~msde,data=dtueal),vcov=NeweyWest(lm(finunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueal))
ch204<-coeftest(lm(finunc1~msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1l<-rtab201

##### Now let us perform the same code for macunc1

dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5))
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5))
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))
dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))

### First look at the high uncertainty sample for Panel (a) of Table A3

cf201<-coeftest(lm(macunc1~l11c2,data=dtucah),vcov=NeweyWest(lm(macunc1~l11c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(macunc1~l11c2,data=dtucah))
cf202<-coeftest(lm(macunc1~l11d2,data=dtudah),vcov=NeweyWest(lm(macunc1~l11d2,data=dtudah),lag=6))
sm202<-summary(lm(macunc1~l11d2,data=dtudah))
cf203<-coeftest(lm(macunc1~l11e2,data=dtueah),vcov=NeweyWest(lm(macunc1~l11e2,data=dtueah),lag=6))
sm203<-summary(lm(macunc1~l11e2,data=dtueah))
cf204<-coeftest(lm(macunc1~l11f2,data=dtufah),vcov=NeweyWest(lm(macunc1~l11f2,data=dtufah),lag=6))
sm204<-summary(lm(macunc1~l11f2,data=dtufah))
cg201<-coeftest(lm(macunc1~l11c2+msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~l11c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(macunc1~l11c2+msdc,data=dtucah))
cg202<-coeftest(lm(macunc1~l11d2+msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~l11d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(macunc1~l11d2+msdd,data=dtudah))
cg203<-coeftest(lm(macunc1~l11e2+msde,data=dtueah),vcov=NeweyWest(lm(macunc1~l11e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(macunc1~l11e2+msde,data=dtueah))
cg204<-coeftest(lm(macunc1~l11f2+msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~l11f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(macunc1~l11f2+msdf,data=dtufah))
ch201<-coeftest(lm(macunc1~msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucah))
ch202<-coeftest(lm(macunc1~msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudah))
ch203<-coeftest(lm(macunc1~msde,data=dtueah),vcov=NeweyWest(lm(macunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueah))
ch204<-coeftest(lm(macunc1~msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(macunc1~l11c2,data=dtucal),vcov=NeweyWest(lm(macunc1~l11c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(macunc1~l11c2,data=dtucal))
cf202<-coeftest(lm(macunc1~l11d2,data=dtudal),vcov=NeweyWest(lm(macunc1~l11d2,data=dtudal),lag=6))
sm202<-summary(lm(macunc1~l11d2,data=dtudal))
cf203<-coeftest(lm(macunc1~l11e2,data=dtueal),vcov=NeweyWest(lm(macunc1~l11e2,data=dtueal),lag=6))
sm203<-summary(lm(macunc1~l11e2,data=dtueal))
cf204<-coeftest(lm(macunc1~l11f2,data=dtufal),vcov=NeweyWest(lm(macunc1~l11f2,data=dtufal),lag=6))
sm204<-summary(lm(macunc1~l11f2,data=dtufal))
cg201<-coeftest(lm(macunc1~l11c2+msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~l11c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(macunc1~l11c2+msdc,data=dtucal))
cg202<-coeftest(lm(macunc1~l11d2+msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~l11d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(macunc1~l11d2+msdd,data=dtudal))
cg203<-coeftest(lm(macunc1~l11e2+msde,data=dtueal),vcov=NeweyWest(lm(macunc1~l11e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(macunc1~l11e2+msde,data=dtueal))
cg204<-coeftest(lm(macunc1~l11f2+msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~l11f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(macunc1~l11f2+msdf,data=dtufal))
ch201<-coeftest(lm(macunc1~msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucal))
ch202<-coeftest(lm(macunc1~msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudal))
ch203<-coeftest(lm(macunc1~msde,data=dtueal),vcov=NeweyWest(lm(macunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueal))
ch204<-coeftest(lm(macunc1~msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1l<-rtab201

### To produce Table 5 we combine the elements

table5<-rbind(rtab201ta3f1h,rtab201ta3f1l,rtab201ta3m1h,rtab201ta3m1l)

write.table(table5,"Table5.csv",sep=",",row.names=FALSE) ### outputs table into working directory
latout(table5,"Table5.txt")

###########################################
# Repeat Table 5 with significance stars #
###########################################

dtucal<-subset(dtuca,dtuca$finunc1<=quantile(dtuca$finunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$finunc1<=quantile(dtuda$finunc1,0.5))
dtueal<-subset(dtuea,dtuea$finunc1<=quantile(dtuea$finunc1,0.5))
dtufal<-subset(dtufa,dtufa$finunc1<=quantile(dtufa$finunc1,0.5))
dtucah<-subset(dtuca,dtuca$finunc1>quantile(dtuca$finunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$finunc1>quantile(dtuda$finunc1,0.5))
dtueah<-subset(dtuea,dtuea$finunc1>quantile(dtuea$finunc1,0.5))
dtufah<-subset(dtufa,dtufa$finunc1>quantile(dtufa$finunc1,0.5))

### First look at the high uncertainty sample for Panel (a) of Table 4

cf201<-coeftest(lm(finunc1~l11c2,data=dtucah),vcov=NeweyWest(lm(finunc1~l11c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(finunc1~l11c2,data=dtucah))
cf202<-coeftest(lm(finunc1~l11d2,data=dtudah),vcov=NeweyWest(lm(finunc1~l11d2,data=dtudah),lag=6))
sm202<-summary(lm(finunc1~l11d2,data=dtudah))
cf203<-coeftest(lm(finunc1~l11e2,data=dtueah),vcov=NeweyWest(lm(finunc1~l11e2,data=dtueah),lag=6))
sm203<-summary(lm(finunc1~l11e2,data=dtueah))
cf204<-coeftest(lm(finunc1~l11f2,data=dtufah),vcov=NeweyWest(lm(finunc1~l11f2,data=dtufah),lag=6))
sm204<-summary(lm(finunc1~l11f2,data=dtufah))
cg201<-coeftest(lm(finunc1~l11c2+msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~l11c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(finunc1~l11c2+msdc,data=dtucah))
cg202<-coeftest(lm(finunc1~l11d2+msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~l11d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(finunc1~l11d2+msdd,data=dtudah))
cg203<-coeftest(lm(finunc1~l11e2+msde,data=dtueah),vcov=NeweyWest(lm(finunc1~l11e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(finunc1~l11e2+msde,data=dtueah))
cg204<-coeftest(lm(finunc1~l11f2+msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~l11f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(finunc1~l11f2+msdf,data=dtufah))
ch201<-coeftest(lm(finunc1~msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucah))
ch202<-coeftest(lm(finunc1~msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudah))
ch203<-coeftest(lm(finunc1~msde,data=dtueah),vcov=NeweyWest(lm(finunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueah))
ch204<-coeftest(lm(finunc1~msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(finunc1~l11c2,data=dtucal),vcov=NeweyWest(lm(finunc1~l11c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(finunc1~l11c2,data=dtucal))
cf202<-coeftest(lm(finunc1~l11d2,data=dtudal),vcov=NeweyWest(lm(finunc1~l11d2,data=dtudal),lag=6))
sm202<-summary(lm(finunc1~l11d2,data=dtudal))
cf203<-coeftest(lm(finunc1~l11e2,data=dtueal),vcov=NeweyWest(lm(finunc1~l11e2,data=dtueal),lag=6))
sm203<-summary(lm(finunc1~l11e2,data=dtueal))
cf204<-coeftest(lm(finunc1~l11f2,data=dtufal),vcov=NeweyWest(lm(finunc1~l11f2,data=dtufal),lag=6))
sm204<-summary(lm(finunc1~l11f2,data=dtufal))
cg201<-coeftest(lm(finunc1~l11c2+msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~l11c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(finunc1~l11c2+msdc,data=dtucal))
cg202<-coeftest(lm(finunc1~l11d2+msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~l11d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(finunc1~l11d2+msdd,data=dtudal))
cg203<-coeftest(lm(finunc1~l11e2+msde,data=dtueal),vcov=NeweyWest(lm(finunc1~l11e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(finunc1~l11e2+msde,data=dtueal))
cg204<-coeftest(lm(finunc1~l11f2+msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~l11f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(finunc1~l11f2+msdf,data=dtufal))
ch201<-coeftest(lm(finunc1~msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucal))
ch202<-coeftest(lm(finunc1~msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudal))
ch203<-coeftest(lm(finunc1~msde,data=dtueal),vcov=NeweyWest(lm(finunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueal))
ch204<-coeftest(lm(finunc1~msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1l<-rtab201

##### Now let us perform the same code for macunc1

dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5))
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5))
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))
dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))

### First look at the high uncertainty sample for Panel (c) of Table 4

cf201<-coeftest(lm(macunc1~l11c2,data=dtucah),vcov=NeweyWest(lm(macunc1~l11c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(macunc1~l11c2,data=dtucah))
cf202<-coeftest(lm(macunc1~l11d2,data=dtudah),vcov=NeweyWest(lm(macunc1~l11d2,data=dtudah),lag=6))
sm202<-summary(lm(macunc1~l11d2,data=dtudah))
cf203<-coeftest(lm(macunc1~l11e2,data=dtueah),vcov=NeweyWest(lm(macunc1~l11e2,data=dtueah),lag=6))
sm203<-summary(lm(macunc1~l11e2,data=dtueah))
cf204<-coeftest(lm(macunc1~l11f2,data=dtufah),vcov=NeweyWest(lm(macunc1~l11f2,data=dtufah),lag=6))
sm204<-summary(lm(macunc1~l11f2,data=dtufah))
cg201<-coeftest(lm(macunc1~l11c2+msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~l11c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(macunc1~l11c2+msdc,data=dtucah))
cg202<-coeftest(lm(macunc1~l11d2+msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~l11d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(macunc1~l11d2+msdd,data=dtudah))
cg203<-coeftest(lm(macunc1~l11e2+msde,data=dtueah),vcov=NeweyWest(lm(macunc1~l11e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(macunc1~l11e2+msde,data=dtueah))
cg204<-coeftest(lm(macunc1~l11f2+msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~l11f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(macunc1~l11f2+msdf,data=dtufah))
ch201<-coeftest(lm(macunc1~msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucah))
ch202<-coeftest(lm(macunc1~msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudah))
ch203<-coeftest(lm(macunc1~msde,data=dtueah),vcov=NeweyWest(lm(macunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueah))
ch204<-coeftest(lm(macunc1~msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(macunc1~l11c2,data=dtucal),vcov=NeweyWest(lm(macunc1~l11c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(macunc1~l11c2,data=dtucal))
cf202<-coeftest(lm(macunc1~l11d2,data=dtudal),vcov=NeweyWest(lm(macunc1~l11d2,data=dtudal),lag=6))
sm202<-summary(lm(macunc1~l11d2,data=dtudal))
cf203<-coeftest(lm(macunc1~l11e2,data=dtueal),vcov=NeweyWest(lm(macunc1~l11e2,data=dtueal),lag=6))
sm203<-summary(lm(macunc1~l11e2,data=dtueal))
cf204<-coeftest(lm(macunc1~l11f2,data=dtufal),vcov=NeweyWest(lm(macunc1~l11f2,data=dtufal),lag=6))
sm204<-summary(lm(macunc1~l11f2,data=dtufal))
cg201<-coeftest(lm(macunc1~l11c2+msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~l11c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(macunc1~l11c2+msdc,data=dtucal))
cg202<-coeftest(lm(macunc1~l11d2+msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~l11d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(macunc1~l11d2+msdd,data=dtudal))
cg203<-coeftest(lm(macunc1~l11e2+msde,data=dtueal),vcov=NeweyWest(lm(macunc1~l11e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(macunc1~l11e2+msde,data=dtueal))
cg204<-coeftest(lm(macunc1~l11f2+msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~l11f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(macunc1~l11f2+msdf,data=dtufal))
ch201<-coeftest(lm(macunc1~msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucal))
ch202<-coeftest(lm(macunc1~msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudal))
ch203<-coeftest(lm(macunc1~msde,data=dtueal),vcov=NeweyWest(lm(macunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueal))
ch204<-coeftest(lm(macunc1~msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1l<-rtab201

### To produce Table 5 we combine the elements

table5s<-rbind(rtab201ta3f1h,rtab201ta3f1l,rtab201ta3m1h,rtab201ta3m1l)

write.table(table5s,"Table5star.csv",sep=",",row.names=FALSE) ### outputs table into working directory
latout(table5s,"Table5star.txt")

###########################################################################################
# At this point it just remains to repeat these L1 norm regressions for the L2 norm. This is Appendix D of the paper 	#
###########################################################################################

#############################################################
# Table A3 presents regressions for the L12 norms based on models 1 to 3 	#
# Models are fitted with Newey-West adjusted standard errors			#
# Note that the code for the table includes 0 in the cells that are blanked out in   	#
# the main paper. It is left to the user to format the tables themselves		#
#############################################################

cf201<-coeftest(lm(l12c2~finunc1,data=dtuca),vcov=NeweyWest(lm(l12c2~finunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just finunc1 as explanatory. This is model 1
sm201<-summary(lm(l12c2~finunc1,data=dtuca))
cf202<-coeftest(lm(l12d2~finunc1,data=dtuda),vcov=NeweyWest(lm(l12d2~finunc1,data=dtuda),lag=6))
sm202<-summary(lm(l12d2~finunc1,data=dtuda))
cf203<-coeftest(lm(l12e2~finunc1,data=dtuea),vcov=NeweyWest(lm(l12e2~finunc1,data=dtuea),lag=6))
sm203<-summary(lm(l12e2~finunc1,data=dtuea))
cf204<-coeftest(lm(l12f2~finunc1,data=dtufa),vcov=NeweyWest(lm(l12f2~finunc1,data=dtufa),lag=6))
sm204<-summary(lm(l12f2~finunc1,data=dtufa))

ch201<-coeftest(lm(l12c2~msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l12c2~msdc,data=dtuca))
ch202<-coeftest(lm(l12d2~msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l12d2~msdd,data=dtuda))
ch203<-coeftest(lm(l12e2~msde,data=dtuea),vcov=NeweyWest(lm(l12e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l12e2~msde,data=dtuea))
ch204<-coeftest(lm(l12f2~msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l12f2~msdf,data=dtufa))

cg201<-coeftest(lm(l12c2~finunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~finunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l12c2~finunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l12d2~finunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~finunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l12d2~finunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l12e2~finunc1+msde,data=dtuea),vcov=NeweyWest(lm(l12e2~finunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l12e2~finunc1+msde,data=dtuea))
cg204<-coeftest(lm(l12f2~finunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~finunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l12f2~finunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### coefficients 

rtab201[3,1]<-round(cf201[2,1],3) ### finunc1 for model 1
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3) ### Volatility for model 2
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3) ### finunc1 for model 3
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3) ### Volatility for model 3
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Now add t-statistics

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")

### Finally add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201f1<-rtab201 ### store

#### rtab201f1  is the raw panel (a) of Table 2 from the main paper

cf201<-coeftest(lm(l12c2~macunc1,data=dtuca),vcov=NeweyWest(lm(l12c2~macunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just macunc1 as explanatory. This is model 1
sm201<-summary(lm(l12c2~macunc1,data=dtuca))
cf202<-coeftest(lm(l12d2~macunc1,data=dtuda),vcov=NeweyWest(lm(l12d2~macunc1,data=dtuda),lag=6))
sm202<-summary(lm(l12d2~macunc1,data=dtuda))
cf203<-coeftest(lm(l12e2~macunc1,data=dtuea),vcov=NeweyWest(lm(l12e2~macunc1,data=dtuea),lag=6))
sm203<-summary(lm(l12e2~macunc1,data=dtuea))
cf204<-coeftest(lm(l12f2~macunc1,data=dtufa),vcov=NeweyWest(lm(l12f2~macunc1,data=dtufa),lag=6))
sm204<-summary(lm(l12f2~macunc1,data=dtufa))

ch201<-coeftest(lm(l12c2~msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l12c2~msdc,data=dtuca))
ch202<-coeftest(lm(l12d2~msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l12d2~msdd,data=dtuda))
ch203<-coeftest(lm(l12e2~msde,data=dtuea),vcov=NeweyWest(lm(l12e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l12e2~msde,data=dtuea))
ch204<-coeftest(lm(l12f2~msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l12f2~msdf,data=dtufa))

cg201<-coeftest(lm(l12c2~macunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~macunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l12c2~macunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l12d2~macunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~macunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l12d2~macunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l12e2~macunc1+msde,data=dtuea),vcov=NeweyWest(lm(l12e2~macunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l12e2~macunc1+msde,data=dtuea))
cg204<-coeftest(lm(l12f2~macunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~macunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l12f2~macunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### coefficients 

rtab201[3,1]<-round(cf201[2,1],3) ### macunc1 for model 1
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3) ### Volatility for model 2
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3) ### macunc1 for model 3
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3) ### Volatility for model 3
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Now add t-statistics

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")

### macally add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201m1<-rtab201

#### rtab201m1 is the raw panel (b) of Table 2 from the main paper

tablea3<-rbind(rtab201f1,rtab201m1)

write.table(tablea3,"TableA3.csv",sep=",",row.names=FALSE) ### Output file into working directory for formatting

#########################################################
# This code produces a version with significance stars 	#
#########################################################

cf201<-coeftest(lm(l12c2~finunc1,data=dtuca),vcov=NeweyWest(lm(l12c2~finunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just finunc1 as explanatory. This is model 1
sm201<-summary(lm(l12c2~finunc1,data=dtuca))
cf202<-coeftest(lm(l12d2~finunc1,data=dtuda),vcov=NeweyWest(lm(l12d2~finunc1,data=dtuda),lag=6))
sm202<-summary(lm(l12d2~finunc1,data=dtuda))
cf203<-coeftest(lm(l12e2~finunc1,data=dtuea),vcov=NeweyWest(lm(l12e2~finunc1,data=dtuea),lag=6))
sm203<-summary(lm(l12e2~finunc1,data=dtuea))
cf204<-coeftest(lm(l12f2~finunc1,data=dtufa),vcov=NeweyWest(lm(l12f2~finunc1,data=dtufa),lag=6))
sm204<-summary(lm(l12f2~finunc1,data=dtufa))

ch201<-coeftest(lm(l12c2~msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l12c2~msdc,data=dtuca))
ch202<-coeftest(lm(l12d2~msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l12d2~msdd,data=dtuda))
ch203<-coeftest(lm(l12e2~msde,data=dtuea),vcov=NeweyWest(lm(l12e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l12e2~msde,data=dtuea))
ch204<-coeftest(lm(l12f2~msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l12f2~msdf,data=dtufa))

cg201<-coeftest(lm(l12c2~finunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~finunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l12c2~finunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l12d2~finunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~finunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l12d2~finunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l12e2~finunc1+msde,data=dtuea),vcov=NeweyWest(lm(l12e2~finunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l12e2~finunc1+msde,data=dtuea))
cg204<-coeftest(lm(l12f2~finunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~finunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l12f2~finunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 


rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")

### Finally add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201f1<-rtab201 ### store

#### rtab201f1  is the raw panel (a) of Table 2 from the main paper with significance stars

cf201<-coeftest(lm(l12c2~macunc1,data=dtuca),vcov=NeweyWest(lm(l12c2~macunc1,data=dtuca),lag=6)) #### Perform the regression on cloud C with just macunc1 as explanatory. This is model 1
sm201<-summary(lm(l12c2~macunc1,data=dtuca))
cf202<-coeftest(lm(l12d2~macunc1,data=dtuda),vcov=NeweyWest(lm(l12d2~macunc1,data=dtuda),lag=6))
sm202<-summary(lm(l12d2~macunc1,data=dtuda))
cf203<-coeftest(lm(l12e2~macunc1,data=dtuea),vcov=NeweyWest(lm(l12e2~macunc1,data=dtuea),lag=6))
sm203<-summary(lm(l12e2~macunc1,data=dtuea))
cf204<-coeftest(lm(l12f2~macunc1,data=dtufa),vcov=NeweyWest(lm(l12f2~macunc1,data=dtufa),lag=6))
sm204<-summary(lm(l12f2~macunc1,data=dtufa))

ch201<-coeftest(lm(l12c2~msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~msdc,data=dtuca),lag=6)) #### Model 2 with volatility only
so201<-summary(lm(l12c2~msdc,data=dtuca))
ch202<-coeftest(lm(l12d2~msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~msdd,data=dtuda),lag=6))
so202<-summary(lm(l12d2~msdd,data=dtuda))
ch203<-coeftest(lm(l12e2~msde,data=dtuea),vcov=NeweyWest(lm(l12e2~msde,data=dtuea),lag=6))
so203<-summary(lm(l12e2~msde,data=dtuea))
ch204<-coeftest(lm(l12f2~msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~msdf,data=dtufa),lag=6))
so204<-summary(lm(l12f2~msdf,data=dtufa))

cg201<-coeftest(lm(l12c2~macunc1+msdc,data=dtuca),vcov=NeweyWest(lm(l12c2~macunc1+msdc,data=dtuca),lag=6)) ### Now perform model 3 with uncertainty and volatility as the explanatory variables
sn201<-summary(lm(l12c2~macunc1+msdc,data=dtuca))
cg202<-coeftest(lm(l12d2~macunc1+msdd,data=dtuda),vcov=NeweyWest(lm(l12d2~macunc1+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(l12d2~macunc1+msdd,data=dtuda))
cg203<-coeftest(lm(l12e2~macunc1+msde,data=dtuea),vcov=NeweyWest(lm(l12e2~macunc1+msde,data=dtuea),lag=6))
sn203<-summary(lm(l12e2~macunc1+msde,data=dtuea))
cg204<-coeftest(lm(l12f2~macunc1+msdf,data=dtufa),vcov=NeweyWest(lm(l12f2~macunc1+msdf,data=dtufa),lag=6))
sn204<-summary(lm(l12f2~macunc1+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)


### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")

### macally add adjusted r-squared for each model.

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201m1<-rtab201

#### rtab201m1 is the raw panel (b) of Table 2 from the main paper

tablea3s<-rbind(rtab201f1,rtab201m1)

write.table(tablea3s,"TableA3star.csv",sep=",",row.names=FALSE) ### Output file into working directory for formatting

# For this table the standard errors are allowed to be negative. You may delete the minus signs in the formatting to produce a version with absolute standard errors.

#############################################################
# Next we estimate Models 4 5 and 6 with uncertainty as the dependent variable	#
#										#
# This will produce Table 3 of the main paper					#
#############################################################


cf201<-coeftest(lm(finunc1~l12c2,data=dtuca),vcov=NeweyWest(lm(finunc1~l12c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(finunc1~l12c2,data=dtuca))
cf202<-coeftest(lm(finunc1~l12d2,data=dtuda),vcov=NeweyWest(lm(finunc1~l12d2,data=dtuda),lag=6))
sm202<-summary(lm(finunc1~l12d2,data=dtuda))
cf203<-coeftest(lm(finunc1~l12e2,data=dtuea),vcov=NeweyWest(lm(finunc1~l12e2,data=dtuea),lag=6))
sm203<-summary(lm(finunc1~l12e2,data=dtuea))
cf204<-coeftest(lm(finunc1~l12f2,data=dtufa),vcov=NeweyWest(lm(finunc1~l12f2,data=dtufa),lag=6))
sm204<-summary(lm(finunc1~l12f2,data=dtufa))

ch201<-coeftest(lm(finunc1~msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(finunc1~msdc,data=dtuca))
ch202<-coeftest(lm(finunc1~msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtuda))
ch203<-coeftest(lm(finunc1~msde,data=dtuea),vcov=NeweyWest(lm(finunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(finunc1~msde,data=dtuea))
ch204<-coeftest(lm(finunc1~msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufa))

cg201<-coeftest(lm(finunc1~l12c2+msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~l12c2+msdc,data=dtuca),lag=6)) ### Then finally model 6
sn201<-summary(lm(finunc1~l12c2+msdc,data=dtuca))
cg202<-coeftest(lm(finunc1~l12d2+msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~l12d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(finunc1~l12d2+msdd,data=dtuda))
cg203<-coeftest(lm(finunc1~l12e2+msde,data=dtuea),vcov=NeweyWest(lm(finunc1~l12e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(finunc1~l12e2+msde,data=dtuea))
cg204<-coeftest(lm(finunc1~l12f2+msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~l12f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(finunc1~l12f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### Add coefficients

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Add t-statistics in parentheses

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3f<-rtab201 ### store for later

#### Now compute panel (b) with macunc1

cf201<-coeftest(lm(macunc1~l12c2,data=dtuca),vcov=NeweyWest(lm(macunc1~l12c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(macunc1~l12c2,data=dtuca))
cf202<-coeftest(lm(macunc1~l12d2,data=dtuda),vcov=NeweyWest(lm(macunc1~l12d2,data=dtuda),lag=6))
sm202<-summary(lm(macunc1~l12d2,data=dtuda))
cf203<-coeftest(lm(macunc1~l12e2,data=dtuea),vcov=NeweyWest(lm(macunc1~l12e2,data=dtuea),lag=6))
sm203<-summary(lm(macunc1~l12e2,data=dtuea))
cf204<-coeftest(lm(macunc1~l12f2,data=dtufa),vcov=NeweyWest(lm(macunc1~l12f2,data=dtufa),lag=6))
sm204<-summary(lm(macunc1~l12f2,data=dtufa))

ch201<-coeftest(lm(macunc1~msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(macunc1~msdc,data=dtuca))
ch202<-coeftest(lm(macunc1~msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtuda))
ch203<-coeftest(lm(macunc1~msde,data=dtuea),vcov=NeweyWest(lm(macunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(macunc1~msde,data=dtuea))
ch204<-coeftest(lm(macunc1~msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufa))

cg201<-coeftest(lm(macunc1~l12c2+msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~l12c2+msdc,data=dtuca),lag=6)) ### Then macally model 6
sn201<-summary(lm(macunc1~l12c2+msdc,data=dtuca))
cg202<-coeftest(lm(macunc1~l12d2+msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~l12d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(macunc1~l12d2+msdd,data=dtuda))
cg203<-coeftest(lm(macunc1~l12e2+msde,data=dtuea),vcov=NeweyWest(lm(macunc1~l12e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(macunc1~l12e2+msde,data=dtuea))
cg204<-coeftest(lm(macunc1~l12f2+msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~l12f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(macunc1~l12f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

### Add coefficients

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

### Add t-statistics in parentheses

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3m<-rtab201 ### store for later

### combine

tablea4<-rbind(rtab201t3f,rtab201t3m)

write.table(tablea4,"TableA4.csv",sep=",",row.names=FALSE)

#############################################################
# Repeating the estimation of Table A4 with stars	#
#############################################################


cf201<-coeftest(lm(finunc1~l12c2,data=dtuca),vcov=NeweyWest(lm(finunc1~l12c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(finunc1~l12c2,data=dtuca))
cf202<-coeftest(lm(finunc1~l12d2,data=dtuda),vcov=NeweyWest(lm(finunc1~l12d2,data=dtuda),lag=6))
sm202<-summary(lm(finunc1~l12d2,data=dtuda))
cf203<-coeftest(lm(finunc1~l12e2,data=dtuea),vcov=NeweyWest(lm(finunc1~l12e2,data=dtuea),lag=6))
sm203<-summary(lm(finunc1~l12e2,data=dtuea))
cf204<-coeftest(lm(finunc1~l12f2,data=dtufa),vcov=NeweyWest(lm(finunc1~l12f2,data=dtufa),lag=6))
sm204<-summary(lm(finunc1~l12f2,data=dtufa))

ch201<-coeftest(lm(finunc1~msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(finunc1~msdc,data=dtuca))
ch202<-coeftest(lm(finunc1~msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtuda))
ch203<-coeftest(lm(finunc1~msde,data=dtuea),vcov=NeweyWest(lm(finunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(finunc1~msde,data=dtuea))
ch204<-coeftest(lm(finunc1~msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufa))

cg201<-coeftest(lm(finunc1~l12c2+msdc,data=dtuca),vcov=NeweyWest(lm(finunc1~l12c2+msdc,data=dtuca),lag=6)) ### Then finally model 6
sn201<-summary(lm(finunc1~l12c2+msdc,data=dtuca))
cg202<-coeftest(lm(finunc1~l12d2+msdd,data=dtuda),vcov=NeweyWest(lm(finunc1~l12d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(finunc1~l12d2+msdd,data=dtuda))
cg203<-coeftest(lm(finunc1~l12e2+msde,data=dtuea),vcov=NeweyWest(lm(finunc1~l12e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(finunc1~l12e2+msde,data=dtuea))
cg204<-coeftest(lm(finunc1~l12f2+msdf,data=dtufa),vcov=NeweyWest(lm(finunc1~l12f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(finunc1~l12f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)


### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3f<-rtab201 ### store for later

#### Now compute panel (b) with macunc1

cf201<-coeftest(lm(macunc1~l12c2,data=dtuca),vcov=NeweyWest(lm(macunc1~l12c2,data=dtuca),lag=6)) #### First model 4
sm201<-summary(lm(macunc1~l12c2,data=dtuca))
cf202<-coeftest(lm(macunc1~l12d2,data=dtuda),vcov=NeweyWest(lm(macunc1~l12d2,data=dtuda),lag=6))
sm202<-summary(lm(macunc1~l12d2,data=dtuda))
cf203<-coeftest(lm(macunc1~l12e2,data=dtuea),vcov=NeweyWest(lm(macunc1~l12e2,data=dtuea),lag=6))
sm203<-summary(lm(macunc1~l12e2,data=dtuea))
cf204<-coeftest(lm(macunc1~l12f2,data=dtufa),vcov=NeweyWest(lm(macunc1~l12f2,data=dtufa),lag=6))
sm204<-summary(lm(macunc1~l12f2,data=dtufa))

ch201<-coeftest(lm(macunc1~msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~msdc,data=dtuca),lag=6)) #### Then model 5
so201<-summary(lm(macunc1~msdc,data=dtuca))
ch202<-coeftest(lm(macunc1~msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~msdd,data=dtuda),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtuda))
ch203<-coeftest(lm(macunc1~msde,data=dtuea),vcov=NeweyWest(lm(macunc1~msde,data=dtuea),lag=6))
so203<-summary(lm(macunc1~msde,data=dtuea))
ch204<-coeftest(lm(macunc1~msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~msdf,data=dtufa),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufa))

cg201<-coeftest(lm(macunc1~l12c2+msdc,data=dtuca),vcov=NeweyWest(lm(macunc1~l12c2+msdc,data=dtuca),lag=6)) ### Then macally model 6
sn201<-summary(lm(macunc1~l12c2+msdc,data=dtuca))
cg202<-coeftest(lm(macunc1~l12d2+msdd,data=dtuda),vcov=NeweyWest(lm(macunc1~l12d2+msdd,,data=dtuda),lag=6))
sn202<-summary(lm(macunc1~l12d2+msdd,data=dtuda))
cg203<-coeftest(lm(macunc1~l12e2+msde,data=dtuea),vcov=NeweyWest(lm(macunc1~l12e2+msde,data=dtuea),lag=6))
sn203<-summary(lm(macunc1~l12e2+msde,data=dtuea))
cg204<-coeftest(lm(macunc1~l12f2+msdf,data=dtufa),vcov=NeweyWest(lm(macunc1~l12f2+msdf,data=dtufa),lag=6))
sn204<-summary(lm(macunc1~l12f2+msdf,data=dtufa))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201t3m<-rtab201 ### store for later

### combine

tablea4s<-rbind(rtab201t3f,rtab201t3m)

write.table(tablea4s,"TableA4star.csv",sep=",",row.names=FALSE)

#######################################################
#  We then consider periods of high and low uncertainty as Table A5	#
#									#
#  In order to achieve this we must first split the sample on finunc1	#
#######################################################

dtucal<-subset(dtuca,dtuca$finunc1<=quantile(dtuca$finunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$finunc1<=quantile(dtuda$finunc1,0.5))
dtueal<-subset(dtuea,dtuea$finunc1<=quantile(dtuea$finunc1,0.5))
dtufal<-subset(dtufa,dtufa$finunc1<=quantile(dtufa$finunc1,0.5))
dtucah<-subset(dtuca,dtuca$finunc1>quantile(dtuca$finunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$finunc1>quantile(dtuda$finunc1,0.5))
dtueah<-subset(dtuea,dtuea$finunc1>quantile(dtuea$finunc1,0.5))
dtufah<-subset(dtufa,dtufa$finunc1>quantile(dtufa$finunc1,0.5))

### First look at the high uncertainty sample for Panel (a) of Table A3

cf201<-coeftest(lm(finunc1~l12c2,data=dtucah),vcov=NeweyWest(lm(finunc1~l12c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(finunc1~l12c2,data=dtucah))
cf202<-coeftest(lm(finunc1~l12d2,data=dtudah),vcov=NeweyWest(lm(finunc1~l12d2,data=dtudah),lag=6))
sm202<-summary(lm(finunc1~l12d2,data=dtudah))
cf203<-coeftest(lm(finunc1~l12e2,data=dtueah),vcov=NeweyWest(lm(finunc1~l12e2,data=dtueah),lag=6))
sm203<-summary(lm(finunc1~l12e2,data=dtueah))
cf204<-coeftest(lm(finunc1~l12f2,data=dtufah),vcov=NeweyWest(lm(finunc1~l12f2,data=dtufah),lag=6))
sm204<-summary(lm(finunc1~l12f2,data=dtufah))
cg201<-coeftest(lm(finunc1~l12c2+msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~l12c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(finunc1~l12c2+msdc,data=dtucah))
cg202<-coeftest(lm(finunc1~l12d2+msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~l12d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(finunc1~l12d2+msdd,data=dtudah))
cg203<-coeftest(lm(finunc1~l12e2+msde,data=dtueah),vcov=NeweyWest(lm(finunc1~l12e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(finunc1~l12e2+msde,data=dtueah))
cg204<-coeftest(lm(finunc1~l12f2+msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~l12f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(finunc1~l12f2+msdf,data=dtufah))
ch201<-coeftest(lm(finunc1~msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucah))
ch202<-coeftest(lm(finunc1~msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudah))
ch203<-coeftest(lm(finunc1~msde,data=dtueah),vcov=NeweyWest(lm(finunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueah))
ch204<-coeftest(lm(finunc1~msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(finunc1~l12c2,data=dtucal),vcov=NeweyWest(lm(finunc1~l12c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(finunc1~l12c2,data=dtucal))
cf202<-coeftest(lm(finunc1~l12d2,data=dtudal),vcov=NeweyWest(lm(finunc1~l12d2,data=dtudal),lag=6))
sm202<-summary(lm(finunc1~l12d2,data=dtudal))
cf203<-coeftest(lm(finunc1~l12e2,data=dtueal),vcov=NeweyWest(lm(finunc1~l12e2,data=dtueal),lag=6))
sm203<-summary(lm(finunc1~l12e2,data=dtueal))
cf204<-coeftest(lm(finunc1~l12f2,data=dtufal),vcov=NeweyWest(lm(finunc1~l12f2,data=dtufal),lag=6))
sm204<-summary(lm(finunc1~l12f2,data=dtufal))
cg201<-coeftest(lm(finunc1~l12c2+msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~l12c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(finunc1~l12c2+msdc,data=dtucal))
cg202<-coeftest(lm(finunc1~l12d2+msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~l12d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(finunc1~l12d2+msdd,data=dtudal))
cg203<-coeftest(lm(finunc1~l12e2+msde,data=dtueal),vcov=NeweyWest(lm(finunc1~l12e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(finunc1~l12e2+msde,data=dtueal))
cg204<-coeftest(lm(finunc1~l12f2+msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~l12f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(finunc1~l12f2+msdf,data=dtufal))
ch201<-coeftest(lm(finunc1~msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucal))
ch202<-coeftest(lm(finunc1~msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudal))
ch203<-coeftest(lm(finunc1~msde,data=dtueal),vcov=NeweyWest(lm(finunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueal))
ch204<-coeftest(lm(finunc1~msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1l<-rtab201

##### Now let us perform the same code for macunc1

dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5))
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5))
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))
dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))

### First look at the high uncertainty sample for Panel (a) of Table A3

cf201<-coeftest(lm(macunc1~l12c2,data=dtucah),vcov=NeweyWest(lm(macunc1~l12c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(macunc1~l12c2,data=dtucah))
cf202<-coeftest(lm(macunc1~l12d2,data=dtudah),vcov=NeweyWest(lm(macunc1~l12d2,data=dtudah),lag=6))
sm202<-summary(lm(macunc1~l12d2,data=dtudah))
cf203<-coeftest(lm(macunc1~l12e2,data=dtueah),vcov=NeweyWest(lm(macunc1~l12e2,data=dtueah),lag=6))
sm203<-summary(lm(macunc1~l12e2,data=dtueah))
cf204<-coeftest(lm(macunc1~l12f2,data=dtufah),vcov=NeweyWest(lm(macunc1~l12f2,data=dtufah),lag=6))
sm204<-summary(lm(macunc1~l12f2,data=dtufah))
cg201<-coeftest(lm(macunc1~l12c2+msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~l12c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(macunc1~l12c2+msdc,data=dtucah))
cg202<-coeftest(lm(macunc1~l12d2+msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~l12d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(macunc1~l12d2+msdd,data=dtudah))
cg203<-coeftest(lm(macunc1~l12e2+msde,data=dtueah),vcov=NeweyWest(lm(macunc1~l12e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(macunc1~l12e2+msde,data=dtueah))
cg204<-coeftest(lm(macunc1~l12f2+msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~l12f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(macunc1~l12f2+msdf,data=dtufah))
ch201<-coeftest(lm(macunc1~msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucah))
ch202<-coeftest(lm(macunc1~msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudah))
ch203<-coeftest(lm(macunc1~msde,data=dtueah),vcov=NeweyWest(lm(macunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueah))
ch204<-coeftest(lm(macunc1~msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(macunc1~l12c2,data=dtucal),vcov=NeweyWest(lm(macunc1~l12c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(macunc1~l12c2,data=dtucal))
cf202<-coeftest(lm(macunc1~l12d2,data=dtudal),vcov=NeweyWest(lm(macunc1~l12d2,data=dtudal),lag=6))
sm202<-summary(lm(macunc1~l12d2,data=dtudal))
cf203<-coeftest(lm(macunc1~l12e2,data=dtueal),vcov=NeweyWest(lm(macunc1~l12e2,data=dtueal),lag=6))
sm203<-summary(lm(macunc1~l12e2,data=dtueal))
cf204<-coeftest(lm(macunc1~l12f2,data=dtufal),vcov=NeweyWest(lm(macunc1~l12f2,data=dtufal),lag=6))
sm204<-summary(lm(macunc1~l12f2,data=dtufal))
cg201<-coeftest(lm(macunc1~l12c2+msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~l12c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(macunc1~l12c2+msdc,data=dtucal))
cg202<-coeftest(lm(macunc1~l12d2+msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~l12d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(macunc1~l12d2+msdd,data=dtudal))
cg203<-coeftest(lm(macunc1~l12e2+msde,data=dtueal),vcov=NeweyWest(lm(macunc1~l12e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(macunc1~l12e2+msde,data=dtueal))
cg204<-coeftest(lm(macunc1~l12f2+msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~l12f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(macunc1~l12f2+msdf,data=dtufal))
ch201<-coeftest(lm(macunc1~msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucal))
ch202<-coeftest(lm(macunc1~msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudal))
ch203<-coeftest(lm(macunc1~msde,data=dtueal),vcov=NeweyWest(lm(macunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueal))
ch204<-coeftest(lm(macunc1~msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

rtab201[1,1]<-round(cf201[1,1],3)
rtab201[1,2]<-round(cf202[1,1],3)
rtab201[1,3]<-round(cf203[1,1],3)
rtab201[1,4]<-round(cf204[1,1],3)
rtab201[1,5]<-round(ch201[1,1],3)
rtab201[1,6]<-round(ch202[1,1],3)
rtab201[1,7]<-round(ch203[1,1],3)
rtab201[1,8]<-round(ch204[1,1],3)
rtab201[1,9]<-round(cg201[1,1],3)
rtab201[1,10]<-round(cg202[1,1],3)
rtab201[1,11]<-round(cg203[1,1],3)
rtab201[1,12]<-round(cg204[1,1],3)

rtab201[3,1]<-round(cf201[2,1],3)
rtab201[3,2]<-round(cf202[2,1],3)
rtab201[3,3]<-round(cf203[2,1],3)
rtab201[3,4]<-round(cf204[2,1],3)
rtab201[3,9]<-round(cg201[2,1],3)
rtab201[3,10]<-round(cg202[2,1],3)
rtab201[3,11]<-round(cg203[2,1],3)
rtab201[3,12]<-round(cg204[2,1],3)
rtab201[5,5]<-round(ch201[2,1],3)
rtab201[5,6]<-round(ch202[2,1],3)
rtab201[5,7]<-round(ch203[2,1],3)
rtab201[5,8]<-round(ch204[2,1],3)
rtab201[5,9]<-round(cg201[3,1],3)
rtab201[5,10]<-round(cg202[3,1],3)
rtab201[5,11]<-round(cg203[3,1],3)
rtab201[5,12]<-round(cg204[3,1],3)

rtab201[2,1]<-paste0("(",round(cf201[1,3],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,3],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,3],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,3],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,3],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,3],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,3],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,3],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,3],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,3],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,3],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,3],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,3],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,3],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,3],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,3],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,3],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,3],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,3],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,3],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,3],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,3],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,3],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,3],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,3],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,3],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,3],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,3],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1l<-rtab201

### To produce Table 4 we combine the elements

tablea5<-rbind(rtab201ta3f1h,rtab201ta3f1l,rtab201ta3m1h,rtab201ta3m1l)

write.table(tablea5,"TableA5.csv",sep=",",row.names=FALSE) ### outputs table into working directory

###########################################
# Repeat Table 4 with significance stars #
###########################################

dtucal<-subset(dtuca,dtuca$finunc1<=quantile(dtuca$finunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$finunc1<=quantile(dtuda$finunc1,0.5))
dtueal<-subset(dtuea,dtuea$finunc1<=quantile(dtuea$finunc1,0.5))
dtufal<-subset(dtufa,dtufa$finunc1<=quantile(dtufa$finunc1,0.5))
dtucah<-subset(dtuca,dtuca$finunc1>quantile(dtuca$finunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$finunc1>quantile(dtuda$finunc1,0.5))
dtueah<-subset(dtuea,dtuea$finunc1>quantile(dtuea$finunc1,0.5))
dtufah<-subset(dtufa,dtufa$finunc1>quantile(dtufa$finunc1,0.5))

### First look at the high uncertainty sample for Panel (a) of Table 4

cf201<-coeftest(lm(finunc1~l12c2,data=dtucah),vcov=NeweyWest(lm(finunc1~l12c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(finunc1~l12c2,data=dtucah))
cf202<-coeftest(lm(finunc1~l12d2,data=dtudah),vcov=NeweyWest(lm(finunc1~l12d2,data=dtudah),lag=6))
sm202<-summary(lm(finunc1~l12d2,data=dtudah))
cf203<-coeftest(lm(finunc1~l12e2,data=dtueah),vcov=NeweyWest(lm(finunc1~l12e2,data=dtueah),lag=6))
sm203<-summary(lm(finunc1~l12e2,data=dtueah))
cf204<-coeftest(lm(finunc1~l12f2,data=dtufah),vcov=NeweyWest(lm(finunc1~l12f2,data=dtufah),lag=6))
sm204<-summary(lm(finunc1~l12f2,data=dtufah))
cg201<-coeftest(lm(finunc1~l12c2+msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~l12c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(finunc1~l12c2+msdc,data=dtucah))
cg202<-coeftest(lm(finunc1~l12d2+msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~l12d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(finunc1~l12d2+msdd,data=dtudah))
cg203<-coeftest(lm(finunc1~l12e2+msde,data=dtueah),vcov=NeweyWest(lm(finunc1~l12e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(finunc1~l12e2+msde,data=dtueah))
cg204<-coeftest(lm(finunc1~l12f2+msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~l12f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(finunc1~l12f2+msdf,data=dtufah))
ch201<-coeftest(lm(finunc1~msdc,data=dtucah),vcov=NeweyWest(lm(finunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucah))
ch202<-coeftest(lm(finunc1~msdd,data=dtudah),vcov=NeweyWest(lm(finunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudah))
ch203<-coeftest(lm(finunc1~msde,data=dtueah),vcov=NeweyWest(lm(finunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueah))
ch204<-coeftest(lm(finunc1~msdf,data=dtufah),vcov=NeweyWest(lm(finunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(finunc1~l12c2,data=dtucal),vcov=NeweyWest(lm(finunc1~l12c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(finunc1~l12c2,data=dtucal))
cf202<-coeftest(lm(finunc1~l12d2,data=dtudal),vcov=NeweyWest(lm(finunc1~l12d2,data=dtudal),lag=6))
sm202<-summary(lm(finunc1~l12d2,data=dtudal))
cf203<-coeftest(lm(finunc1~l12e2,data=dtueal),vcov=NeweyWest(lm(finunc1~l12e2,data=dtueal),lag=6))
sm203<-summary(lm(finunc1~l12e2,data=dtueal))
cf204<-coeftest(lm(finunc1~l12f2,data=dtufal),vcov=NeweyWest(lm(finunc1~l12f2,data=dtufal),lag=6))
sm204<-summary(lm(finunc1~l12f2,data=dtufal))
cg201<-coeftest(lm(finunc1~l12c2+msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~l12c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(finunc1~l12c2+msdc,data=dtucal))
cg202<-coeftest(lm(finunc1~l12d2+msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~l12d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(finunc1~l12d2+msdd,data=dtudal))
cg203<-coeftest(lm(finunc1~l12e2+msde,data=dtueal),vcov=NeweyWest(lm(finunc1~l12e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(finunc1~l12e2+msde,data=dtueal))
cg204<-coeftest(lm(finunc1~l12f2+msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~l12f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(finunc1~l12f2+msdf,data=dtufal))
ch201<-coeftest(lm(finunc1~msdc,data=dtucal),vcov=NeweyWest(lm(finunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(finunc1~msdc,data=dtucal))
ch202<-coeftest(lm(finunc1~msdd,data=dtudal),vcov=NeweyWest(lm(finunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(finunc1~msdd,data=dtudal))
ch203<-coeftest(lm(finunc1~msde,data=dtueal),vcov=NeweyWest(lm(finunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(finunc1~msde,data=dtueal))
ch204<-coeftest(lm(finunc1~msdf,data=dtufal),vcov=NeweyWest(lm(finunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(finunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3f1l<-rtab201

##### Now let us perform the same code for macunc1

dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5))
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5))
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))
dtucal<-subset(dtuca,dtuca$macunc1<=quantile(dtuca$macunc1,0.5)) ### Low uncertainty at or below median
dtudal<-subset(dtuda,dtuda$macunc1<=quantile(dtuda$macunc1,0.5))
dtueal<-subset(dtuea,dtuea$macunc1<=quantile(dtuea$macunc1,0.5))
dtufal<-subset(dtufa,dtufa$macunc1<=quantile(dtufa$macunc1,0.5))
dtucah<-subset(dtuca,dtuca$macunc1>quantile(dtuca$macunc1,0.5)) ### High uncertainty above median
dtudah<-subset(dtuda,dtuda$macunc1>quantile(dtuda$macunc1,0.5))
dtueah<-subset(dtuea,dtuea$macunc1>quantile(dtuea$macunc1,0.5))
dtufah<-subset(dtufa,dtufa$macunc1>quantile(dtufa$macunc1,0.5))

### First look at the high uncertainty sample for Panel (c) of Table 4

cf201<-coeftest(lm(macunc1~l12c2,data=dtucah),vcov=NeweyWest(lm(macunc1~l12c2,data=dtucah),lag=6)) ####
sm201<-summary(lm(macunc1~l12c2,data=dtucah))
cf202<-coeftest(lm(macunc1~l12d2,data=dtudah),vcov=NeweyWest(lm(macunc1~l12d2,data=dtudah),lag=6))
sm202<-summary(lm(macunc1~l12d2,data=dtudah))
cf203<-coeftest(lm(macunc1~l12e2,data=dtueah),vcov=NeweyWest(lm(macunc1~l12e2,data=dtueah),lag=6))
sm203<-summary(lm(macunc1~l12e2,data=dtueah))
cf204<-coeftest(lm(macunc1~l12f2,data=dtufah),vcov=NeweyWest(lm(macunc1~l12f2,data=dtufah),lag=6))
sm204<-summary(lm(macunc1~l12f2,data=dtufah))
cg201<-coeftest(lm(macunc1~l12c2+msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~l12c2+msdc,data=dtucah),lag=6))
sn201<-summary(lm(macunc1~l12c2+msdc,data=dtucah))
cg202<-coeftest(lm(macunc1~l12d2+msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~l12d2+msdd,,data=dtudah),lag=6))
sn202<-summary(lm(macunc1~l12d2+msdd,data=dtudah))
cg203<-coeftest(lm(macunc1~l12e2+msde,data=dtueah),vcov=NeweyWest(lm(macunc1~l12e2+msde,data=dtueah),lag=6))
sn203<-summary(lm(macunc1~l12e2+msde,data=dtueah))
cg204<-coeftest(lm(macunc1~l12f2+msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~l12f2+msdf,data=dtufah),lag=6))
sn204<-summary(lm(macunc1~l12f2+msdf,data=dtufah))
ch201<-coeftest(lm(macunc1~msdc,data=dtucah),vcov=NeweyWest(lm(macunc1~msdc,data=dtucah),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucah))
ch202<-coeftest(lm(macunc1~msdd,data=dtudah),vcov=NeweyWest(lm(macunc1~msdd,data=dtudah),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudah))
ch203<-coeftest(lm(macunc1~msde,data=dtueah),vcov=NeweyWest(lm(macunc1~msde,data=dtueah),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueah))
ch204<-coeftest(lm(macunc1~msdf,data=dtufah),vcov=NeweyWest(lm(macunc1~msdf,data=dtufah),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufah))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")

rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1h<-rtab201

### Now we look at the lower uncertainty period

cf201<-coeftest(lm(macunc1~l12c2,data=dtucal),vcov=NeweyWest(lm(macunc1~l12c2,data=dtucal),lag=6)) ####
sm201<-summary(lm(macunc1~l12c2,data=dtucal))
cf202<-coeftest(lm(macunc1~l12d2,data=dtudal),vcov=NeweyWest(lm(macunc1~l12d2,data=dtudal),lag=6))
sm202<-summary(lm(macunc1~l12d2,data=dtudal))
cf203<-coeftest(lm(macunc1~l12e2,data=dtueal),vcov=NeweyWest(lm(macunc1~l12e2,data=dtueal),lag=6))
sm203<-summary(lm(macunc1~l12e2,data=dtueal))
cf204<-coeftest(lm(macunc1~l12f2,data=dtufal),vcov=NeweyWest(lm(macunc1~l12f2,data=dtufal),lag=6))
sm204<-summary(lm(macunc1~l12f2,data=dtufal))
cg201<-coeftest(lm(macunc1~l12c2+msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~l12c2+msdc,data=dtucal),lag=6))
sn201<-summary(lm(macunc1~l12c2+msdc,data=dtucal))
cg202<-coeftest(lm(macunc1~l12d2+msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~l12d2+msdd,,data=dtudal),lag=6))
sn202<-summary(lm(macunc1~l12d2+msdd,data=dtudal))
cg203<-coeftest(lm(macunc1~l12e2+msde,data=dtueal),vcov=NeweyWest(lm(macunc1~l12e2+msde,data=dtueal),lag=6))
sn203<-summary(lm(macunc1~l12e2+msde,data=dtueal))
cg204<-coeftest(lm(macunc1~l12f2+msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~l12f2+msdf,data=dtufal),lag=6))
sn204<-summary(lm(macunc1~l12f2+msdf,data=dtufal))
ch201<-coeftest(lm(macunc1~msdc,data=dtucal),vcov=NeweyWest(lm(macunc1~msdc,data=dtucal),lag=6)) #### Standard deviation only
so201<-summary(lm(macunc1~msdc,data=dtucal))
ch202<-coeftest(lm(macunc1~msdd,data=dtudal),vcov=NeweyWest(lm(macunc1~msdd,data=dtudal),lag=6))
so202<-summary(lm(macunc1~msdd,data=dtudal))
ch203<-coeftest(lm(macunc1~msde,data=dtueal),vcov=NeweyWest(lm(macunc1~msde,data=dtueal),lag=6))
so203<-summary(lm(macunc1~msde,data=dtueal))
ch204<-coeftest(lm(macunc1~msdf,data=dtufal),vcov=NeweyWest(lm(macunc1~msdf,data=dtufal),lag=6))
so204<-summary(lm(macunc1~msdf,data=dtufal))

rtab201<-matrix(0,nrow=7,ncol=12)

### Place intercepts into first row

rtab201[1,1]<-paste0(round(cf201[1,1],3),ifelse(cf201[1,4]>0.05,"",ifelse(cf201[1,4]>0.01,"*",ifelse(cf201[1,4]>0.001,"**","***")))) ### Intercept for model 1
rtab201[1,2]<-paste0(round(cf202[1,1],3),ifelse(cf202[1,4]>0.05,"",ifelse(cf202[1,4]>0.01,"*",ifelse(cf202[1,4]>0.001,"**","***")))) 
rtab201[1,3]<-paste0(round(cf203[1,1],3),ifelse(cf203[1,4]>0.05,"",ifelse(cf203[1,4]>0.01,"*",ifelse(cf203[1,4]>0.001,"**","***")))) 
rtab201[1,4]<-paste0(round(cf204[1,1],3),ifelse(cf204[1,4]>0.05,"",ifelse(cf204[1,4]>0.01,"*",ifelse(cf204[1,4]>0.001,"**","***")))) 
rtab201[1,5]<-paste0(round(ch201[1,1],3),ifelse(ch201[1,4]>0.05,"",ifelse(ch201[1,4]>0.01,"*",ifelse(ch201[1,4]>0.001,"**","***")))) ### Intercept for model 2
rtab201[1,6]<-paste0(round(ch202[1,1],3),ifelse(ch202[1,4]>0.05,"",ifelse(ch202[1,4]>0.01,"*",ifelse(ch202[1,4]>0.001,"**","***")))) 
rtab201[1,7]<-paste0(round(ch203[1,1],3),ifelse(ch203[1,4]>0.05,"",ifelse(ch203[1,4]>0.01,"*",ifelse(ch203[1,4]>0.001,"**","***")))) 
rtab201[1,8]<-paste0(round(ch204[1,1],3),ifelse(ch204[1,4]>0.05,"",ifelse(ch204[1,4]>0.01,"*",ifelse(ch204[1,4]>0.001,"**","***")))) 
rtab201[1,9]<-paste0(round(cg201[1,1],3),ifelse(cg201[1,4]>0.05,"",ifelse(cg201[1,4]>0.01,"*",ifelse(cg201[1,4]>0.001,"**","***")))) ### Intercept for model 3
rtab201[1,10]<-paste0(round(cg202[1,1],3),ifelse(cg202[1,4]>0.05,"",ifelse(cg202[1,4]>0.01,"*",ifelse(cg202[1,4]>0.001,"**","***")))) 
rtab201[1,11]<-paste0(round(cg203[1,1],3),ifelse(cg203[1,4]>0.05,"",ifelse(cg203[1,4]>0.01,"*",ifelse(cg203[1,4]>0.001,"**","***")))) 
rtab201[1,12]<-paste0(round(cg204[1,1],3),ifelse(cg204[1,4]>0.05,"",ifelse(cg204[1,4]>0.01,"*",ifelse(cg204[1,4]>0.001,"**","***")))) 


### coefficients 

rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[3,1]<-paste0(round(cf201[2,1],3),ifelse(cf201[2,4]>0.05,"",ifelse(cf201[2,4]>0.01,"*",ifelse(cf201[2,4]>0.001,"**","***")))) ### finunc1 for model 1
rtab201[3,2]<-paste0(round(cf202[2,1],3),ifelse(cf202[2,4]>0.05,"",ifelse(cf202[2,4]>0.01,"*",ifelse(cf202[2,4]>0.001,"**","***")))) 
rtab201[3,3]<-paste0(round(cf203[2,1],3),ifelse(cf203[2,4]>0.05,"",ifelse(cf203[2,4]>0.01,"*",ifelse(cf203[2,4]>0.001,"**","***")))) 
rtab201[3,4]<-paste0(round(cf204[2,1],3),ifelse(cf204[2,4]>0.05,"",ifelse(cf204[2,4]>0.01,"*",ifelse(cf204[2,4]>0.001,"**","***")))) 
rtab201[5,5]<-paste0(round(ch201[2,1],3),ifelse(ch201[2,4]>0.05,"",ifelse(ch201[2,4]>0.01,"*",ifelse(ch201[2,4]>0.001,"**","***")))) ### volatility for model 2
rtab201[5,6]<-paste0(round(ch202[2,1],3),ifelse(ch202[2,4]>0.05,"",ifelse(ch202[2,4]>0.01,"*",ifelse(ch202[2,4]>0.001,"**","***")))) 
rtab201[5,7]<-paste0(round(ch203[2,1],3),ifelse(ch203[2,4]>0.05,"",ifelse(ch203[2,4]>0.01,"*",ifelse(ch203[2,4]>0.001,"**","***")))) 
rtab201[5,8]<-paste0(round(ch204[2,1],3),ifelse(ch204[2,4]>0.05,"",ifelse(ch204[2,4]>0.01,"*",ifelse(ch204[2,4]>0.001,"**","***")))) 
rtab201[3,9]<-paste0(round(cg201[2,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### finunc1 for model 3
rtab201[3,10]<-paste0(round(cg202[2,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[3,11]<-paste0(round(cg203[2,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[3,12]<-paste0(round(cg204[2,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***")))) 
rtab201[5,9]<-paste0(round(cg201[3,1],3),ifelse(cg201[2,4]>0.05,"",ifelse(cg201[2,4]>0.01,"*",ifelse(cg201[2,4]>0.001,"**","***")))) ### volatility for model 3
rtab201[5,10]<-paste0(round(cg202[3,1],3),ifelse(cg202[2,4]>0.05,"",ifelse(cg202[2,4]>0.01,"*",ifelse(cg202[2,4]>0.001,"**","***")))) 
rtab201[5,11]<-paste0(round(cg203[3,1],3),ifelse(cg203[2,4]>0.05,"",ifelse(cg203[2,4]>0.01,"*",ifelse(cg203[2,4]>0.001,"**","***")))) 
rtab201[5,12]<-paste0(round(cg204[3,1],3),ifelse(cg204[2,4]>0.05,"",ifelse(cg204[2,4]>0.01,"*",ifelse(cg204[2,4]>0.001,"**","***"))))

### Now add standard errors

rtab201[2,1]<-paste0("(",round(cf201[1,2],3),")")
rtab201[2,2]<-paste0("(",round(cf202[1,2],3),")")
rtab201[2,3]<-paste0("(",round(cf203[1,2],3),")")
rtab201[2,4]<-paste0("(",round(cf204[1,2],3),")")
rtab201[2,5]<-paste0("(",round(ch201[1,2],3),")")
rtab201[2,6]<-paste0("(",round(ch202[1,2],3),")")
rtab201[2,7]<-paste0("(",round(ch203[1,2],3),")")
rtab201[2,8]<-paste0("(",round(ch204[1,2],3),")")
rtab201[2,9]<-paste0("(",round(cg201[1,2],3),")")
rtab201[2,10]<-paste0("(",round(cg202[1,2],3),")")
rtab201[2,11]<-paste0("(",round(cg203[1,2],3),")")
rtab201[2,12]<-paste0("(",round(cg204[1,2],3),")")
rtab201[4,1]<-paste0("(",round(cf201[2,2],3),")")
rtab201[4,2]<-paste0("(",round(cf202[2,2],3),")")
rtab201[4,3]<-paste0("(",round(cf203[2,2],3),")")
rtab201[4,4]<-paste0("(",round(cf204[2,2],3),")")
rtab201[4,9]<-paste0("(",round(cg201[2,2],3),")")
rtab201[4,10]<-paste0("(",round(cg202[2,2],3),")")
rtab201[4,11]<-paste0("(",round(cg203[2,2],3),")")
rtab201[4,12]<-paste0("(",round(cg204[2,2],3),")")
rtab201[6,5]<-paste0("(",round(ch201[2,2],3),")")
rtab201[6,6]<-paste0("(",round(ch202[2,2],3),")")
rtab201[6,7]<-paste0("(",round(ch203[2,2],3),")")
rtab201[6,8]<-paste0("(",round(ch204[2,2],3),")")
rtab201[6,9]<-paste0("(",round(cg201[3,2],3),")")
rtab201[6,10]<-paste0("(",round(cg202[3,2],3),")")
rtab201[6,11]<-paste0("(",round(cg203[3,2],3),")")
rtab201[6,12]<-paste0("(",round(cg204[3,2],3),")")


rtab201[7,1]<-round(sm201[[8]],3)
rtab201[7,2]<-round(sm202[[8]],3)
rtab201[7,3]<-round(sm203[[8]],3)
rtab201[7,4]<-round(sm204[[8]],3)
rtab201[7,5]<-round(so201[[8]],3)
rtab201[7,6]<-round(so202[[8]],3)
rtab201[7,7]<-round(so203[[8]],3)
rtab201[7,8]<-round(so204[[8]],3)
rtab201[7,9]<-round(sn201[[8]],3)
rtab201[7,10]<-round(sn202[[8]],3)
rtab201[7,11]<-round(sn203[[8]],3)
rtab201[7,12]<-round(sn204[[8]],3)

### Blank out

rtab201[3,5]<-""
rtab201[3,6]<-""
rtab201[3,7]<-""
rtab201[3,8]<-""
rtab201[4,5]<-""
rtab201[4,6]<-""
rtab201[4,7]<-""
rtab201[4,8]<-""
rtab201[5,1]<-""
rtab201[5,2]<-""
rtab201[5,3]<-""
rtab201[5,4]<-""
rtab201[6,1]<-""
rtab201[6,2]<-""
rtab201[6,3]<-""
rtab201[6,4]<-""

rtab201ta3m1l<-rtab201

### To produce Table A5 with stars we combine the elements

tablea5s<-rbind(rtab201ta3f1h,rtab201ta3f1l,rtab201ta3m1h,rtab201ta3m1l)

write.table(tablea5s,"TableA5star.csv",sep=",",row.names=FALSE) ### outputs table into working directory






###################################################################################################################
# If you have made use of all or part of this code please do not forget to cite the paper 									#
#																			#
# Suggested citation: Rudkin, S., Qiu, W., and Dlotko, P. (2021) "Uncertainty, volatility and the persistence norms of financial time series", working paper 	#
###################################################################################################################


# User defined latex function

latout<-function(data,filename){
 if(missing(filename)) filename<-"latout.txt"
 a001<-nrow(data)
 a002<-ncol(data)
 a003<-a002-1
 mat1<-matrix(0,nrow=a001,ncol=1)
 for(i in 1:a001){
   for(k in 1:a003){
     mat1[i,1]<-paste(mat1[i,1],data[i,k],sep="&")
   }
 }
 for(i in 1:a001){
  mat1[i,1]<-paste0(mat1[i,1],"&",data[i,a002],"\\","\\")
 }
 write.table(as.data.frame(mat1),filename,sep="\n",row.names=FALSE,quote=FALSE)
} 

latout(cm4,"Table1.txt")
latout(table2,"Table2.txt")
latout(table2s,"Table2s.txt")
latout(table3,"Table3.txt")
latout(table3s,"Table3s.txt")
latout(table4,"Table4.txt")
latout(table4s,"Table4s.txt")
latout(v004,"viftable.txt")
latout(tablea3,"TableA3.txt")
latout(tablea3s,"TableA3s.txt")
latout(tablea4,"TableA4.txt")
latout(tablea4s,"TableA4s.txt")
latout(tablea5,"TableA5.txt")
latout(tablea5s,"TableA5s.txt")